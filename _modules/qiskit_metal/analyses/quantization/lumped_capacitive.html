<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>qiskit_metal.analyses.quantization.lumped_capacitive - Quantum Metal 0.5.2</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/qiskit-sphinx-theme.css?v=8ff9dcb6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=IBM+Plex+Sans:ital,wght@0,400;0,600;1,400;1,600&display=swap" rel="stylesheet"></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M14 2H2C1.73478 2 1.48043 2.10536 1.29289 2.29289C1.10536 2.48043 1 2.73478 1 3V13C1 13.2652 1.10536 13.5196 1.29289 13.7071C1.48043 13.8946 1.73478 14 2 14H14C14.2652 14 14.5196 13.8946 14.7071 13.7071C14.8946 13.5196 15 13.2652 15 13V3C15 2.73478 14.8946 2.48043 14.7071 2.29289C14.5196 2.10536 14.2652 2 14 2V2ZM2 3H10V13H2V3ZM14 13H11V3H14V13Z" fill="currentColor"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M14 3H2V4H14V3Z" fill="currentColor"/>
      <path d="M14 12H2V13H14V12Z" fill="currentColor"/>
      <path d="M14 6H2V7H14V6Z" fill="currentColor"/>
      <path d="M14 9H2V10H14V9Z" fill="currentColor"/>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M11 8L6.00005 13L5.30005 12.3L9.60005 8L5.30005 3.7L6.00005 3L11 8Z" fill="currentColor"/>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M15 13H1V14H15V13Z" fill="currentColor"/>
      <path d="M12.7 4.5C13.1 4.1 13.1 3.5 12.7 3.1L10.9 1.3C10.5 0.9 9.9 0.9 9.5 1.3L2 8.8V12H5.2L12.7 4.5ZM10.2 2L12 3.8L10.5 5.3L8.7 3.5L10.2 2ZM3 11V9.2L8 4.2L9.8 6L4.8 11H3Z" fill="currentColor"/>
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M11 13.0002C11.5523 13.0002 12 12.5525 12 12.0002C12 11.4479 11.5523 11.0002 11 11.0002C10.4477 11.0002 10 11.4479 10 12.0002C10 12.5525 10.4477 13.0002 11 13.0002Z" fill="currentColor"/>
      <path d="M14.8884 11.7394C14.5795 10.9524 14.0464 10.2734 13.3552 9.78646C12.664 9.29954 11.8451 9.02615 11 9.00017C10.1549 9.02615 9.33604 9.29954 8.64484 9.78646C7.95365 10.2734 7.42052 10.9524 7.11155 11.7394L7 12.0002L7.11155 12.2609C7.42052 13.0479 7.95365 13.727 8.64484 14.2139C9.33604 14.7008 10.1549 14.9742 11 15.0002C11.8451 14.9742 12.664 14.7008 13.3552 14.2139C14.0464 13.727 14.5795 13.0479 14.8884 12.2609L15 12.0002L14.8884 11.7394ZM11 14.0002C10.6044 14.0002 10.2178 13.8829 9.88886 13.6631C9.55996 13.4433 9.30362 13.131 9.15224 12.7655C9.00087 12.4001 8.96126 11.998 9.03843 11.61C9.1156 11.222 9.30608 10.8657 9.58579 10.586C9.86549 10.3063 10.2219 10.1158 10.6098 10.0386C10.9978 9.96143 11.3999 10.001 11.7654 10.1524C12.1308 10.3038 12.4432 10.5601 12.6629 10.889C12.8827 11.2179 13 11.6046 13 12.0002C12.9994 12.5304 12.7885 13.0388 12.4136 13.4137C12.0386 13.7887 11.5303 13.9996 11 14.0002Z" fill="currentColor"/>
      <path d="M6 14.0002H4V2.00017H8V5.00017C8.00077 5.26515 8.10637 5.51906 8.29374 5.70643C8.48111 5.8938 8.73502 5.99941 9 6.00017H12V8.00017H13V5.00017C13.0018 4.93446 12.9893 4.86913 12.9634 4.80871C12.9375 4.74828 12.8988 4.6942 12.85 4.65017L9.35 1.15017C9.30599 1.10134 9.2519 1.06263 9.19147 1.03674C9.13104 1.01084 9.06572 0.998364 9 1.00017H4C3.73502 1.00094 3.48111 1.10654 3.29374 1.29391C3.10637 1.48128 3.00077 1.73519 3 2.00017V14.0002C3.00077 14.2652 3.10637 14.5191 3.29374 14.7064C3.48111 14.8938 3.73502 14.9994 4 15.0002H6V14.0002ZM9 2.20017L11.8 5.00017H9V2.20017Z" fill="currentColor"/>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">Quantum Metal 0.5.2</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  
  <span class="sidebar-brand-text">Quantum Metal 0.5.2</span>
  
</a>
<form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installing Qiskit Metal</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../workflow.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../workflow.html#qiskit-metal-workflow">Qiskit Metal Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../workflow.html#quantization-methods-overview">Quantization Methods Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributor-guide.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../videoseducation.html">Videos &amp; Education</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../tut/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/1-Overview/1.1-Bird%27s-eye-view-of-Qiskit-Metal.html">Bird’s eye view of Qiskit Metal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/1-Overview/1.2-Quick-start.html">Quick Start: Build your first 4-qubit processor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/1-Overview/1.3-Saving-Your-Chip-Design.html">Save your chip design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.01-How-to-use-a-QComponent.html">How to use a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#QComponent-Default-Options">QComponent Default Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Modifying-the-Options">Modifying the Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Copying-a-QComponent">Copying a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Deleting-a-QComponent">Deleting a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Renaming-a-QComponent">Renaming a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Overwriting-a-QComponent">Overwriting a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Closing-the-Qiskit-Metal-GUI">Closing the Qiskit Metal GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.02-How-to-copy-a-QComponent.html">How to copy a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.11-Routing-101.html">Routing 101</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.12-Simple-Meander.html">Simple Meander</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.12-Simple-Meander.html#Using-CPW-meanders-to-connect-the-3-Qbits">Using CPW meanders to connect the 3 Qbits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.13-Hybrid-Auto-and-AStar.html">Hybrid Auto and AStar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.14-Get-them-all-with-MixedRoute.html">Get them all with MixedRoute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.21-Design-a-4-qubit-full-chip.html">Design a 4 qubit full chip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.22-Design-100-qubits-programmatically.html">Design 100 qubits programmatically</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.23-Modify-chip-options.html">Modify chip options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.31-Create-a-QComponent-Basic.html">Create a QComponent - Basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.32-Create-a-QComponent-Advanced.html">Create a QComponent - Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/2-From-components-to-chip/2.33-Add-my-QComponent-to-a-reusable-python-file.html">Add my QComponent to a reusable python file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/3-Renderers/3.1-Introduction-to-QRenderers.html">Introduction to QRenderers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/3-Renderers/3.1-Introduction-to-QRenderers.html#Note:">Note:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/3-Renderers/3.2-Export-your-design-to-GDS.html">Export your design to GDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/3-Renderers/3.3-Render-your-design-to-Ansys.html">Render your design to Ansys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/3-Renderers/3.4-How-do-I-make-my-custom-QRenderer.html">How do I make my custom QRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.01-Capacitance-and-LOM.html">Capacitance matrix and LOM analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.02-Eigenmode-and-EPR.html">Eigenmode and EPR analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.03-Impedance.html">Impedance, admittance and scattering analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.11-Analyze-and-tune-a-transmon.html">Analyzing and tuning a transmon qubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.11-Analyze-and-tune-a-transmon.html#1.-Create-the-Qbit-design">1. Create the Qbit design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.12-Analyze-a-resonator.html">Analyzing and tuning a resonator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.13-Analyze-transmon-and-resonator.html">Analyzing and tuning a transmon qubit with a resonator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.14-Analyze-a-double-hanger-resonator.html">Analyzing a double hanger resonator (S Param)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.15-CPW-kappa-calculation.html">CPW Kappa Calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.21-Capacitance-matrix.html">Sweeps - Capacitance matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.21-Capacitance-matrix.html#READ-THIS-BEFORE-running-the-cell.">READ THIS BEFORE running the cell.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.22-Eigenmode-matrix.html">Sweeps - Eigenmode matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.23-Impedance-and-scattering-Z-S-Y-matrices.html">Sweeps - Impedance, scattering and admittance (Z S Y) matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.31-Plot-quantum-oscillator-wavefunction.html">Plotting Wavefunctions of the Quantum Harmonic Oscillator (LC Circuit)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.32-Transmon-analytics-HCPB.html">Transmon Analytics: Plotting Eigenvalues as a Function of Offset Charge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.33-Transmon-analytics.html">Transmon Analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/4-Analysis/4.34-Transmon-qubit-CPB-hamiltonian-charge-basis.html">Modeling transmon qubit Cooper-pair box Hamiltonian in the charge basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/quick-topics/JJ-Demo-Notebook.html">Josephson Junction QComponent Demo Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/quick-topics/Managing-pins.html">Managing pins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/quick-topics/Managing-variables.html">Managing variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/quick-topics/Opening-documentation.html">Opening the documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/quick-topics/QComponent-3-fingers-capacitor.html">QComponent - 3-fingers capacitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tut/quick-topics/QComponent-Interdigitated-transmon.html">QComponent - Interdigitated transmon qubit</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../circuit-examples/index.html">Example Designs</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Example Designs</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/01-Transmon_cross.html">Single Transmon - Grounded (xmon)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/02-Transmon_floating.html">Single Transmon - Floating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/03-concentric_transmon.html">Concentric Transmon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/04-Interdigitated_Transmon.html">Interdigitated Transmon Qubits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/05-Transmon_cross_fl.html">Single Transmon - Grounded (xmon) flux lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/06-Transmon_floating_6.html">Single Transmon - Floating with 6 connection pads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/07-Transmon_floating_cl.html">Single Transmon - Floating with charge lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/08-JJ-Dolan.html">Josephson Junction (Dolan)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/09-JJ-Manhattan.html">Josephson Junction (Manhattan)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/10-Transmon_floating_teeth.html">Single Transmon - Floating with teeth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/11-Star_shaped_qubit.html">Star shaped qubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/11-Star_shaped_qubit.html#A-Star-Qubit">A Star Qubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/A.Qubits/11-Star_shaped_qubit.html#Closing-the-Qiskit-Metal-GUI">Closing the Qiskit Metal GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/B.Resonators/11-Resonator_Meander.html">Simple CPW Meander</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/C.Composite-bi-partite/21-OneTransmonsWithMeanderAndOTG.html">Transmon coupled to CPW resonator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/D.Qubit-couplers/31-TwoCrossmonsTunableCoupler.html">Tunable Coupler (MIT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/D.Qubit-couplers/32-TwoTransmonsDirectCoupling.html">Direct Coupler (transmon-transmon)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/D.Qubit-couplers/33-TwoTransmonsWithMeander.html">Bus Resonator Coupler (transmon-transmon)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/E.Input-output-coupling/41-LaunchPad.html">CPW Launch Pad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/E.Input-output-coupling/42-ResonatorAndLaunchPad.html">Readout line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/E.Input-output-coupling/43-TransmonPocketCL.html">Charge Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/F.Small-quantum-chips/51-Four_qubit_chip.html">Four Qubit Chip Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/full-design-flow-examples/Example-full-chip-design.html">Example full chip design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/full-design-flow-examples/Example-used-in-the-launch-video.html">Launch Videos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../circuit-examples/full-design-flow-examples/Exercise-for-the-South-Korea-Hackathon%2720.html">South Korea Qiskit Hackathon’20 - Qiskit Metal exercise</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Libraries</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apidocs/qlibrary.html">All Quantum Devices</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of All Quantum Devices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.QComponent.html">QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.ParsedDynamicAttributes_Component.html">ParsedDynamicAttributes_Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.BaseQubit.html">BaseQubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.QRoute.html">QRoute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.QRouteLead.html">QRouteLead</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.QRoutePoint.html">QRoutePoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.CircleCaterpillar.html">CircleCaterpillar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.CircleRaster.html">CircleRaster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.NGon.html">NGon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.NSquareSpiral.html">NSquareSpiral</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.Rectangle.html">Rectangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RectangleHollow.html">RectangleHollow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.Cap3Interdigital.html">Cap3Interdigital</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.CapNInterdigital.html">CapNInterdigital</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.ResonatorCoilRect.html">ResonatorCoilRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.CoupledLineTee.html">CoupledLineTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.LineTee.html">LineTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.CapNInterdigitalTee.html">CapNInterdigitalTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TunableCoupler01.html">TunableCoupler01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TunableCoupler02.html">TunableCoupler02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.ReadoutResFC.html">ReadoutResFC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.ResonatorLumped.html">ResonatorLumped</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebond.html">LaunchpadWirebond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebondCoupled.html">LaunchpadWirebondCoupled</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebondDriven.html">LaunchpadWirebondDriven</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.OpenToGround.html">OpenToGround</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.ShortToGround.html">ShortToGround</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RouteStraight.html">RouteStraight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RouteFramed.html">RouteFramed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RouteMeander.html">RouteMeander</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RouteAnchors.html">RouteAnchors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RouteMixed.html">RouteMixed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RoutePathfinder.html">RoutePathfinder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.jj_dolan.html">jj_dolan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.jj_manhattan.html">jj_manhattan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonConcentric.html">TransmonConcentric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonConcentricType2.html">TransmonConcentricType2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonCross.html">TransmonCross</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonCrossFL.html">TransmonCrossFL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonInterdigitated.html">TransmonInterdigitated</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonPocket.html">TransmonPocket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonPocketCL.html">TransmonPocketCL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonPocket6.html">TransmonPocket6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonPocketTeeth.html">TransmonPocketTeeth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TunableCoupler01.html">TunableCoupler01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.SQUID_LOOP.html">SQUID_LOOP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.StarQubit.html">StarQubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.anchored_path.html">anchored_path</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../overview.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apidocs/designs.html">QDesigns</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of QDesigns</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.designs.QDesign.html">QDesign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.designs.DesignPlanar.html">DesignPlanar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.designs.MultiPlanar.html">MultiPlanar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.designs.DesignFlipChip.html">DesignFlipChip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.designs.QNet.html">QNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.designs.Components.html">Components</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apidocs/qlibrary.html">QComponents</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of QComponents</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.QComponent.html">QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.ParsedDynamicAttributes_Component.html">ParsedDynamicAttributes_Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.BaseQubit.html">BaseQubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.QRoute.html">QRoute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.QRouteLead.html">QRouteLead</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.QRoutePoint.html">QRoutePoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.CircleCaterpillar.html">CircleCaterpillar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.CircleRaster.html">CircleRaster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.NGon.html">NGon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.NSquareSpiral.html">NSquareSpiral</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.Rectangle.html">Rectangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RectangleHollow.html">RectangleHollow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.Cap3Interdigital.html">Cap3Interdigital</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.CapNInterdigital.html">CapNInterdigital</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.ResonatorCoilRect.html">ResonatorCoilRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.CoupledLineTee.html">CoupledLineTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.LineTee.html">LineTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.CapNInterdigitalTee.html">CapNInterdigitalTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TunableCoupler01.html">TunableCoupler01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TunableCoupler02.html">TunableCoupler02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.ReadoutResFC.html">ReadoutResFC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.ResonatorLumped.html">ResonatorLumped</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebond.html">LaunchpadWirebond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebondCoupled.html">LaunchpadWirebondCoupled</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebondDriven.html">LaunchpadWirebondDriven</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.OpenToGround.html">OpenToGround</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.ShortToGround.html">ShortToGround</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RouteStraight.html">RouteStraight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RouteFramed.html">RouteFramed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RouteMeander.html">RouteMeander</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RouteAnchors.html">RouteAnchors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RouteMixed.html">RouteMixed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.RoutePathfinder.html">RoutePathfinder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.jj_dolan.html">jj_dolan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.jj_manhattan.html">jj_manhattan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonConcentric.html">TransmonConcentric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonConcentricType2.html">TransmonConcentricType2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonCross.html">TransmonCross</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonCrossFL.html">TransmonCrossFL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonInterdigitated.html">TransmonInterdigitated</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonPocket.html">TransmonPocket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonPocketCL.html">TransmonPocketCL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonPocket6.html">TransmonPocket6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TransmonPocketTeeth.html">TransmonPocketTeeth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.TunableCoupler01.html">TunableCoupler01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.SQUID_LOOP.html">SQUID_LOOP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.StarQubit.html">StarQubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qlibrary.anchored_path.html">anchored_path</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apidocs/analyses.html">Analyses</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Analyses</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.QAnalysis.html">QAnalysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.QSimulation.html">QSimulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.Hcpb.html">Hcpb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.Hcpb_analytic.html">Hcpb_analytic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.HO_wavefunctions.html">HO_wavefunctions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.transmon_analytics.html">transmon_analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.cpw_calculations.html">cpw_calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.kappa_calculation.html">kappa_calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.Sweeper.html">Sweeper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.LOManalysis.html">LOManalysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.EPRanalysis.html">EPRanalysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html">lumped_capacitive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.LumpedElementsSim.html">LumpedElementsSim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.EigenmodeSim.html">EigenmodeSim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.analyses.ScatteringImpedanceSim.html">ScatteringImpedanceSim</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apidocs/renderers.html">QRenderes</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of QRenderes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QRenderer.html">QRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QRendererGui.html">QRendererGui</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QRendererAnalysis.html">QRendererAnalysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.PlotCanvas.html">PlotCanvas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.MplInteraction.html">MplInteraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.ZoomOnWheel.html">ZoomOnWheel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.PanAndZoom.html">PanAndZoom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QMplRenderer.html">QMplRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.AnimatedText.html">AnimatedText</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QGDSRenderer.html">QGDSRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.Cheesing.html">Cheesing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QAnsysRenderer.html">QAnsysRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QHFSSRenderer.html">QHFSSRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QQ3DRenderer.html">QQ3DRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QPyaedt.html">QPyaedt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QQ3DPyaedt.html">QQ3DPyaedt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QHFSSPyaedt.html">QHFSSPyaedt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QHFSSDrivenmodalPyaedt.html">QHFSSDrivenmodalPyaedt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QHFSSEigenmodePyaedt.html">QHFSSEigenmodePyaedt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.QGmshRenderer.html">QGmshRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.renderers.Vec3DArray.html">Vec3DArray</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apidocs/toolbox_metal.html">Toolbox</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Toolbox</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.toolbox_metal.QiskitMetalExceptions.html">QiskitMetalExceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.toolbox_metal.QiskitMetalDesignError.html">QiskitMetalDesignError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.toolbox_metal.about.html">about</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.toolbox_metal.import_export.html">import_export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.toolbox_metal.math_and_overrides.html">math_and_overrides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.toolbox_metal.parsing.html">parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.toolbox_metal.layer_stack_handler.html">layer_stack_handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.toolbox_metal.bounds_for_path_and_poly_tables.html">bounds_for_path_and_poly_tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.toolbox_metal.determine_larger_box.html">determine_larger_box</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apidocs/qgeometries.html">QGeometry</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of QGeometry</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal.qgeometries.QGeometryTables.html">QGeometryTables</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apidocs/gui.html">GUI</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of GUI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apidocs/qiskit_metal._gui.MetalGUI.html">MetalGUI</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Qiskit/qiskit/blob/master/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
</ul>

</div></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for qiskit_metal.analyses.quantization.lumped_capacitive</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># This code is part of Qiskit.</span>
<span class="c1">#</span>
<span class="c1"># (C) Copyright IBM 2017, 2021.</span>
<span class="c1">#</span>
<span class="c1"># This code is licensed under the Apache License, Version 2.0. You may</span>
<span class="c1"># obtain a copy of this license in the LICENSE.txt file in the root directory</span>
<span class="c1"># of this source tree or at http://www.apache.org/licenses/LICENSE-2.0.</span>
<span class="c1">#</span>
<span class="c1"># Any modifications or derivative works of this code must retain this</span>
<span class="c1"># copyright notice, and modified files need to carry a notice indicating</span>
<span class="c1"># that they have been altered from the originals.</span>
<span class="sd">&quot;&quot;&quot;Handles the capacitive simulation of a transmon pocket model.</span>

<span class="sd">Convert capacitance matrices extracted from Q3D into Hamiltonian parameters</span>
<span class="sd">using the Duffing model. Typical input is the capacitance matrix calculated from Q3D.</span>

<span class="sd">Each function prints out the parameters and outputs a dictionary.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># pylint: disable=invalid-name</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">opt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pint</span><span class="w"> </span><span class="kn">import</span> <span class="n">UnitRegistry</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyEPR.calcs.convert</span><span class="w"> </span><span class="kn">import</span> <span class="n">Convert</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.constants</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">hbar</span><span class="p">,</span> <span class="n">phinot</span><span class="p">,</span> <span class="n">phi0</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Ic_from_Lj&#39;</span><span class="p">,</span> <span class="s1">&#39;Ic_from_Ej&#39;</span><span class="p">,</span> <span class="s1">&#39;Cs_from_Ec&#39;</span><span class="p">,</span> <span class="s1">&#39;transmon_props&#39;</span><span class="p">,</span> <span class="s1">&#39;chi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;extract_transmon_coupled_Noscillator&#39;</span><span class="p">,</span> <span class="s1">&#39;levels_vs_ng_real_units&#39;</span><span class="p">,</span>
    <span class="s1">&#39;get_C_and_Ic&#39;</span><span class="p">,</span> <span class="s1">&#39;cos_to_mega_and_delta&#39;</span><span class="p">,</span> <span class="s1">&#39;chargeline_T1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;readin_q3d_matrix&#39;</span><span class="p">,</span> <span class="s1">&#39;readin_q3d_matrix_m&#39;</span><span class="p">,</span> <span class="s1">&#39;load_q3d_capacitance_matrix&#39;</span><span class="p">,</span>
    <span class="s1">&#39;df_cmat_style_print&#39;</span><span class="p">,</span> <span class="s1">&#39;move_index_to&#39;</span><span class="p">,</span> <span class="s1">&#39;df_reorder_matrix_basis&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lumped_oscillator_from_path&#39;</span>
<span class="p">]</span>


<div class="viewcode-block" id="Ic_from_Lj">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.Ic_from_Lj">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Ic_from_Lj</span><span class="p">(</span><span class="n">Lj</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Critical current In SI units.</span>

<span class="sd">    Args:</span>
<span class="sd">        Lj (float): In Henries</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: In Amps</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">phi0</span> <span class="o">/</span> <span class="n">Lj</span></div>



<div class="viewcode-block" id="Ic_from_Ej">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.Ic_from_Ej">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Ic_from_Ej</span><span class="p">(</span><span class="n">Ej</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Critical current In SI units.</span>

<span class="sd">    Args:</span>
<span class="sd">        Ej (float): In Joules</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: In Amps</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Ej</span> <span class="o">/</span> <span class="n">phi0</span></div>



<div class="viewcode-block" id="Cs_from_Ec">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.Cs_from_Ec">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Cs_from_Ec</span><span class="p">(</span><span class="n">Ec</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get total shunt capacitance from charging energy In SI units.</span>

<span class="sd">    Args:</span>
<span class="sd">        Ec (float): In Joules</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: In farads</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Ec</span><span class="p">)</span></div>



<div class="viewcode-block" id="transmon_props">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.transmon_props">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">transmon_props</span><span class="p">(</span><span class="n">Ic</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Cq</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Properties of a transmon qubit.</span>

<span class="sd">    Calculate LJ, EJ, EC, wq, eps from Ic,Cq.</span>

<span class="sd">    Args:</span>
<span class="sd">        Ic (float): Junction Ic (in A)</span>
<span class="sd">        Cq (float): Junction capacitance (in F)</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: [LJ, EJ, Zqp, EC, wq, wq0, eps1] -- Inductance</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">LJ</span> <span class="o">=</span> <span class="n">phi0</span> <span class="o">/</span> <span class="n">Ic</span>
    <span class="n">EJ</span> <span class="o">=</span> <span class="n">phi0</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">LJ</span> <span class="o">/</span> <span class="n">hbar</span>
    <span class="n">Zqp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">LJ</span> <span class="o">/</span> <span class="n">Cq</span><span class="p">)</span>
    <span class="n">EC</span> <span class="o">=</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">Cq</span> <span class="o">/</span> <span class="n">hbar</span>
    <span class="n">wq0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">LJ</span> <span class="o">*</span> <span class="n">Cq</span><span class="p">)</span>
    <span class="n">wq</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">LJ</span> <span class="o">*</span> <span class="n">Cq</span><span class="p">)</span> <span class="o">-</span> <span class="n">EC</span>

    <span class="c1"># charge dispersion</span>
    <span class="n">eps1</span> <span class="o">=</span> <span class="n">EC</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">9</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> \
        <span class="p">(</span><span class="n">EJ</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">EC</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.25</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">EJ</span><span class="o">/</span><span class="n">EC</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">LJ</span><span class="p">,</span> <span class="n">EJ</span><span class="p">,</span> <span class="n">Zqp</span><span class="p">,</span> <span class="n">EC</span><span class="p">,</span> <span class="n">wq</span><span class="p">,</span> <span class="n">wq0</span><span class="p">,</span> <span class="n">eps1</span></div>



<span class="c1"># TODO: Move to a more generic file</span>


<div class="viewcode-block" id="chi">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.chi">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">chi</span><span class="p">(</span><span class="n">g</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">wr</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">w01</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">w12</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the dispersive shift $\chi$, where $2*\chi$ is</span>
<span class="sd">    the `|0&gt; --&gt; |1&gt;` splitting).</span>

<span class="sd">    Accounts for push on the i-th transmon level due to the j-th transmon level,</span>
<span class="sd">    mediated by cavity.</span>

<span class="sd">    All args need to be in the same units.</span>

<span class="sd">    Args:</span>
<span class="sd">        g (float): Qubit-cavity linear coupling.</span>
<span class="sd">        wr (float): Frequency of resonator.</span>
<span class="sd">        w01 (float): Qubit 01 transition frequency</span>
<span class="sd">        w12 (float): Qubit 12 transition frequency</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Calculated chi value</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Push on the i-th transmon level due to the j-th transmon level</span>
    <span class="c1"># mediated by cavity</span>

    <span class="c1"># shift of the zero state</span>
    <span class="c1"># In this case i=0 and j=1.</span>
    <span class="n">chibus_0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">w01</span> <span class="o">/</span> <span class="p">(</span><span class="n">w01</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">wr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Koch Eq. (3.10)</span>

    <span class="c1"># shift of the 1 state</span>
    <span class="c1"># the g of the levels scales rougly as sqrt(n), so the 2 for the 2 / (w12 - wr)</span>
    <span class="n">chibus_1</span> <span class="o">=</span> <span class="n">g</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">w01</span> <span class="o">-</span> <span class="n">wr</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">w12</span> <span class="o">-</span> <span class="n">wr</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">w01</span> <span class="o">+</span> <span class="n">wr</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">/</span>
                       <span class="p">(</span><span class="n">w12</span> <span class="o">+</span> <span class="n">wr</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">chibus_1</span> <span class="o">-</span> <span class="n">chibus_0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># Koch Eq. (3.9)</span></div>



<div class="viewcode-block" id="extract_transmon_coupled_Noscillator">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.extract_transmon_coupled_Noscillator">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">extract_transmon_coupled_Noscillator</span><span class="p">(</span><span class="n">capMatrix</span><span class="p">,</span>
                                         <span class="n">Ic</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                                         <span class="n">CJ</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                                         <span class="n">N</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                                         <span class="n">fb</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
                                         <span class="n">fr</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                                         <span class="n">res_L4_corr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                         <span class="n">g_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                                         <span class="n">print_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Primary analysis function called by the user for lumped-element mode</span>
<span class="sd">    (LOM) analysis. Uses a Maxwell capacitance matrix generated by a capacitive</span>
<span class="sd">    extractor, such as Q3D. Additionally takes more values to determine many</span>
<span class="sd">    parameters of the Hamiltonian of the system.</span>

<span class="sd">    The capMatrix can be imported using `readin_q3d_matrix`</span>

<span class="sd">    Calculate the χ The full dispersive splitting using analytical</span>
<span class="sd">    approximations, i.e., return the `|0&gt; --&gt; |1&gt;` splitting.</span>

<span class="sd">    Args:</span>
<span class="sd">        capMatrix (np.ndarray): Order of the capacitance matrix must be</span>
<span class="sd">          bus1...busN-1, ground, Qubit_pad1, Qubit_pad2, readout. (in F)</span>
<span class="sd">          If not in the correct order, use df_reorder_matrix_basis() to put</span>
<span class="sd">          it in the proper order. It is advised that the user follow a naming scheme</span>
<span class="sd">          in QiskitMetal or Q3D which results in the necessary order by default (eg. alphabetical)</span>
<span class="sd">        Ic (float): Junction Ic (in A)</span>
<span class="sd">        Cj (float): Junction capacitance (in F)</span>
<span class="sd">        N (int): Coupling pads (1 readout, N-1 bus)</span>
<span class="sd">        fb (float): Coupling bus and readout frequencies (in GHz).</span>
<span class="sd">                    fb can be a list with the order the order they appear in the capMatrix.</span>
<span class="sd">        fr (float): Coupling bus and readout frequencies (in GHz).</span>
<span class="sd">                    fr can be a list with the order the order they appear in the capMatrix.</span>
<span class="sd">        res_L4_corr (list): Correction factor is the resonators are L/4</span>
<span class="sd">          if none it ignores, otherwise this is a list of length N</span>
<span class="sd">          in the form [1,0,1,...].  Defaults to None.</span>
<span class="sd">        g_scale (float): Scale factor</span>
<span class="sd">        print_info (bool): Print transmon and coupling properties. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: `ham_dict` is a dictionary of all the calculated values</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If N is not positive</span>
<span class="sd">        ValueError: If the capacitance matrix is the wrong size</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Error checks</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;N must positive&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">capMatrix</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Capacitance matrix is not the right size&#39;</span><span class="p">)</span>

    <span class="c1"># make list of angular frequencies of resonators</span>
    <span class="n">wr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># angular freq of resonators (GHz-rad)</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># readout resonator</span>
            <span class="n">wr</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fr</span> <span class="o">*</span> <span class="mf">1e9</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>  <span class="c1"># just a single one</span>
                <span class="n">wr</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fb</span> <span class="o">*</span> <span class="mf">1e9</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">wr</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fb</span><span class="p">[</span><span class="n">ii</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e9</span>  <span class="c1"># offset index by</span>

    <span class="c1">########################################################</span>
    <span class="c1">#### Transmission line properties</span>

    <span class="c1"># Initial values</span>
    <span class="n">Zbus</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">Cr</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="n">wr</span> <span class="o">*</span> <span class="n">Zbus</span><span class="p">)</span>
    <span class="n">Lr</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">wr</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">Cr</span>

    <span class="c1"># L/4 resonators have an effective capacitance that is</span>
    <span class="c1"># half the L/2 case (and likewise the Lr is twice) at the</span>
    <span class="c1"># same resonance frequency</span>
    <span class="c1"># DCM (I think from numerics)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">res_L4_corr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res_L4_corr</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">res_L4_corr</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">Cr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="mf">2.0</span>
                <span class="n">Lr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">2.0</span>

    <span class="c1">########################################################</span>
    <span class="c1"># Capacitance matrix parsing</span>

    <span class="n">ground_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">qubit_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">ground_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ground_index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">bus_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">bus_index</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">capMatrix</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bus_index</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">ii</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># Cg list of qubit pads to ground</span>
    <span class="n">Cg</span> <span class="o">=</span> <span class="p">[</span>
        <span class="o">-</span><span class="n">capMatrix</span><span class="p">[</span><span class="n">qubit_index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ground_index</span><span class="p">],</span>
        <span class="o">-</span><span class="n">capMatrix</span><span class="p">[</span><span class="n">qubit_index</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ground_index</span><span class="p">]</span>
    <span class="p">]</span>

    <span class="c1"># Cs qubit pads to each other</span>
    <span class="n">Cs</span> <span class="o">=</span> <span class="o">-</span><span class="n">capMatrix</span><span class="p">[</span><span class="n">qubit_index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qubit_index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

    <span class="c1"># Cbus (qubit pads to coupling pads)</span>
    <span class="c1"># index is ordered as [readout,bus1,...]</span>
    <span class="n">Cbus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">Cbus</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">capMatrix</span><span class="p">[</span><span class="n">qubit_index</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">bus_index</span><span class="p">[</span><span class="n">jj</span><span class="p">]]</span>

    <span class="c1"># crosspad capacitance</span>
    <span class="n">Cbusbus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ii</span> <span class="o">!=</span> <span class="n">jj</span><span class="p">:</span>
                <span class="n">Cbusbus</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">capMatrix</span><span class="p">[</span><span class="n">bus_index</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">bus_index</span><span class="p">[</span><span class="n">jj</span><span class="p">]]</span>

    <span class="c1"># sum of capacitances from each pad to ground</span>
    <span class="c1"># this assumes the bus couplers are at &quot;ground&quot;</span>
    <span class="n">C1S</span> <span class="o">=</span> <span class="n">Cg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Cbus</span><span class="p">[</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">])</span>
    <span class="n">C2S</span> <span class="o">=</span> <span class="n">Cg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Cbus</span><span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
    <span class="p">])</span>

    <span class="c1"># total capacitance between pads</span>
    <span class="n">tCSq</span> <span class="o">=</span> <span class="n">Cs</span> <span class="o">+</span> <span class="n">C1S</span> <span class="o">*</span> <span class="n">C2S</span> <span class="o">/</span> <span class="p">(</span><span class="n">C1S</span> <span class="o">+</span> <span class="n">C2S</span><span class="p">)</span>  <span class="c1"># Key equation</span>

    <span class="c1"># total capacitance of each pad to ground?</span>
    <span class="c1"># Note the + in the squared term below !!!</span>
    <span class="n">tCSbus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">tCSbus</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">Cr</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">Cbus</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">+</span><span class="n">Cbus</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> \
            <span class="p">(</span><span class="n">C1S</span><span class="o">+</span><span class="n">C2S</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Cbus</span><span class="p">[:,</span> <span class="n">ii</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Cbusbus</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="p">:])</span>

    <span class="c1"># qubit to coupling pad capacitance</span>
    <span class="n">tCqbus</span> <span class="o">=</span> <span class="p">(</span><span class="n">C2S</span> <span class="o">*</span> <span class="n">Cbus</span><span class="p">[</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">-</span> <span class="n">Cbus</span><span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">*</span> <span class="n">C1S</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">C1S</span> <span class="o">+</span> <span class="n">C2S</span><span class="p">)</span>

    <span class="c1"># coupling pad to coupling pad capacitance</span>
    <span class="n">tCqbusbus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">tCqbusbus</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">Cbusbus</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">+</span> \
                <span class="p">(</span><span class="n">Cbus</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span><span class="o">+</span><span class="n">Cbus</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ii</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">Cbus</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span><span class="o">+</span><span class="n">Cbus</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">jj</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">C1S</span><span class="o">+</span><span class="n">C2S</span><span class="p">)</span>

    <span class="c1"># voltage division ratio</span>
    <span class="n">bbus</span> <span class="o">=</span> <span class="p">(</span><span class="n">C2S</span> <span class="o">*</span> <span class="n">Cbus</span><span class="p">[</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">-</span> <span class="n">Cbus</span><span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">*</span> <span class="n">C1S</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">C1S</span> <span class="o">+</span> <span class="n">C2S</span><span class="p">)</span> <span class="o">*</span> <span class="n">Cs</span> <span class="o">+</span> <span class="n">C1S</span> <span class="o">*</span> <span class="n">C2S</span><span class="p">)</span>

    <span class="c1"># total qubit capacitance (including junction capacitance)</span>
    <span class="n">Cq</span> <span class="o">=</span> <span class="n">tCSq</span> <span class="o">+</span> <span class="n">CJ</span>

    <span class="c1">########################################################</span>
    <span class="c1">##### Transmon qubit &amp; bus quantum properties</span>

    <span class="c1"># get transmon properties given Ic and Cq</span>
    <span class="n">LJ</span><span class="p">,</span> <span class="n">EJ</span><span class="p">,</span> <span class="n">Zqp</span><span class="p">,</span> <span class="n">EC</span><span class="p">,</span> <span class="n">wq</span><span class="p">,</span> <span class="n">wq0</span><span class="p">,</span> <span class="n">eps1</span> <span class="o">=</span> <span class="n">transmon_props</span><span class="p">(</span><span class="n">Ic</span><span class="p">,</span> <span class="n">Cq</span><span class="p">)</span>

    <span class="c1"># get numerical properties</span>
    <span class="n">fq</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="n">tphi_ms</span> <span class="o">=</span> <span class="n">levels_vs_ng_real_units</span><span class="p">(</span><span class="n">Cq</span> <span class="o">/</span> <span class="mf">1e-15</span><span class="p">,</span>
                                                       <span class="n">Ic</span> <span class="o">/</span> <span class="mf">1e-9</span><span class="p">,</span>
                                                       <span class="n">N</span><span class="o">=</span><span class="mi">51</span><span class="p">)</span>
    <span class="n">wq</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fq</span> <span class="o">*</span> <span class="mf">1e9</span>

    <span class="c1"># effective impedances of the coupling pads (?)</span>
    <span class="n">Zbus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Lr</span> <span class="o">/</span> <span class="n">tCSbus</span><span class="p">)</span>

    <span class="c1"># matrix of the qubit and couplings with a single ground node</span>
    <span class="c1">#    Cm = np.zeros([N+1,N+1])</span>

    <span class="c1">#    Cm = np.array([[Cq, -tCqr1, -tCqr2],</span>
    <span class="c1">#        [-tCqr1, tCSr1, -tCr1r2],</span>
    <span class="c1">#        [-tCqr2, -tCr1r2, tCSr2]])</span>
    <span class="c1">#</span>
    <span class="c1">#    Cminv = np.linalg.inv(Cm)</span>
    <span class="c1">#</span>
    <span class="c1">#    #readout g</span>
    <span class="c1">#    gr0 = 0.5*Cminv[0,1]/np.sqrt(Zqp*Zr1p)</span>
    <span class="c1">#    print(&#39;gr0 = %f [MHz]&#39;%(gr0/2/np.pi/1e6))</span>

    <span class="c1"># g&#39;s from the qubit</span>
    <span class="n">gqbus</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wr</span> <span class="o">*</span> <span class="n">bbus</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Zbus</span> <span class="o">/</span> <span class="n">Zqp</span><span class="p">)</span> <span class="o">*</span> <span class="n">g_scale</span>
    <span class="c1">#gbus = bbus*wr*np.sqrt(Zbus)*e*(EJ/8/EC)**(1/4)/np.sqrt(hbar)</span>
    <span class="n">gbus_in_MHz</span> <span class="o">=</span> <span class="n">gqbus</span> <span class="o">/</span> <span class="mf">1e6</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="c1"># g&#39;s between pads</span>
    <span class="n">gbusbus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">gbusbus</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span>
                    <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">)</span> <span class="o">*</span> <span class="n">tCqbusbus</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">tCSbus</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">*</span> <span class="n">tCSbus</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span>

    <span class="c1">########################################################</span>
    <span class="c1">##### Purcell, Qs, dissipative</span>

    <span class="c1"># guesses for the Q&#39;s</span>
    <span class="n">Qreadout</span> <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">Qcouplingbus</span> <span class="o">=</span> <span class="mf">1e5</span>
    <span class="n">Qbus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Qbus</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">Qreadout</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Qbus</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">Qcouplingbus</span>

    <span class="c1"># loss tangent</span>
    <span class="n">kbus</span> <span class="o">=</span> <span class="n">wr</span> <span class="o">/</span> <span class="n">Qbus</span>

    <span class="c1"># purcell due to each coupling bus</span>
    <span class="n">T1bus</span> <span class="o">=</span> <span class="p">(</span><span class="n">wr</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">wq</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">kbus</span> <span class="o">*</span> <span class="n">gqbus</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">wq</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># total T1</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">T1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">T1bus</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">T1</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="c1">########################################################</span>
    <span class="c1">##### Transmon properties and final summary</span>

    <span class="c1"># chi&#39;s</span>
    <span class="c1">#d = -EC</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1e6</span>
    <span class="n">Chi_in_MHz</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">chi</span><span class="p">(</span><span class="n">gqbus</span><span class="p">,</span> <span class="n">wr</span><span class="p">,</span> <span class="n">wq</span><span class="p">,</span>
                         <span class="n">d</span> <span class="o">+</span> <span class="n">wq</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">1e6</span>  <span class="c1"># Total chi in MHz</span>

    <span class="n">ham_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;fQ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wq</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">1E9</span>
    <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EC</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">1E6</span>
    <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;EJ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EJ</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">1E9</span>
    <span class="c1"># correction to the anharmonicity (from eq 52 of solgun et al.)</span>
    <span class="c1">#ham_dict[&#39;alpha&#39;] = ((wq0/wq)**2*ham_dict[&#39;EC&#39;])</span>
    <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha</span>
    <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;dispersion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">disp</span> <span class="o">/</span> <span class="mf">1e3</span>
    <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;gbus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gbus_in_MHz</span>
    <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;chi_in_MHz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Chi_in_MHz</span>

    <span class="k">if</span> <span class="n">print_info</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">qubit_index</span><span class="p">,</span> <span class="n">bus_index</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predicted Values&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Transmon Properties&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f_Q </span><span class="si">%f</span><span class="s1"> [GHz]&#39;</span> <span class="o">%</span> <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;fQ&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;EC </span><span class="si">%f</span><span class="s1"> [MHz]&#39;</span> <span class="o">%</span> <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;EC&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;EJ </span><span class="si">%f</span><span class="s1"> [GHz]&#39;</span> <span class="o">%</span> <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;EJ&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;alpha </span><span class="si">%f</span><span class="s1"> [MHz]&#39;</span> <span class="o">%</span> <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dispersion </span><span class="si">%f</span><span class="s1"> [KHz]&#39;</span> <span class="o">%</span> <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;dispersion&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Lq </span><span class="si">%f</span><span class="s1"> [nH]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">phi0</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">hbar</span> <span class="o">*</span> <span class="n">EJ</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e-9</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cq </span><span class="si">%f</span><span class="s1"> [fF]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Cq</span> <span class="o">/</span> <span class="mf">1e-15</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T1 </span><span class="si">%f</span><span class="s1"> [us]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">T1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1e-6</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;**Coupling Properties**&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">tCqbus</span><span class="si">%d</span><span class="s1"> </span><span class="si">%f</span><span class="s1"> [fF]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tCqbus</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1e-15</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gbus</span><span class="si">%d</span><span class="s1">_in_MHz </span><span class="si">%f</span><span class="s1"> [MHz]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ham_dict</span><span class="p">[</span><span class="s1">&#39;gbus&#39;</span><span class="p">][</span><span class="n">ii</span><span class="p">]))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;χ_bus</span><span class="si">%d</span><span class="s1"> </span><span class="si">%f</span><span class="s1"> [MHz]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Chi_in_MHz</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1/T1bus</span><span class="si">%d</span><span class="s1"> </span><span class="si">%f</span><span class="s1"> [Hz]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">T1bus</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T1bus</span><span class="si">%d</span><span class="s1"> </span><span class="si">%f</span><span class="s1"> [us]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">T1bus</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1e-6</span><span class="p">)))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Bus-Bus Couplings&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gbus</span><span class="si">%d</span><span class="s1">_</span><span class="si">%d</span><span class="s1"> </span><span class="si">%f</span><span class="s1"> [MHz]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jj</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gbusbus</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">/</span>
                                              <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">ham_dict</span></div>



<div class="viewcode-block" id="levels_vs_ng_real_units">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.levels_vs_ng_real_units">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">levels_vs_ng_real_units</span><span class="p">(</span><span class="n">Cq</span><span class="p">,</span> <span class="n">IC</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">301</span><span class="p">,</span> <span class="n">do_disp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">do_plots</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This numerically computes the exact transmon levels given C and IC as a</span>
<span class="sd">    function of the ng ration -- it subtracts the vacuum flucations so that</span>
<span class="sd">    the ground state is set to zero energy.</span>

<span class="sd">    Args:</span>
<span class="sd">        C (float): In fF</span>
<span class="sd">        Ic (float): In nA</span>
<span class="sd">        N (int): Number of charge values to use (needs to be odd)</span>
<span class="sd">        do_disp (int): Will print out the values</span>
<span class="sd">        do_plots (int): Will plot the data</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: fqubitGHz, anharMHz, disp, tphi_ms</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the matrix is not Hermitian</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">Cq</span> <span class="o">*</span> <span class="mf">1e-15</span>
    <span class="n">IC</span> <span class="o">=</span> <span class="n">IC</span> <span class="o">*</span> <span class="mf">1e-9</span>
    <span class="n">Ec</span> <span class="o">=</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">C</span>

    <span class="n">nmax</span> <span class="o">=</span> <span class="mi">40</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">nmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">])</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">nmat</span>
    <span class="n">charge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

    <span class="c1"># KE</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
        <span class="n">nmat</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">ii</span> <span class="o">-</span> <span class="n">nmax</span>

    <span class="c1"># PE</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">V</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">V</span><span class="p">)))</span>

    <span class="n">varphi</span> <span class="o">=</span> <span class="n">hbar</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">e</span>
    <span class="n">EJ</span> <span class="o">=</span> <span class="n">IC</span> <span class="o">*</span> <span class="n">varphi</span>

    <span class="n">elvls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">dim</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">iindex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">ng</span> <span class="o">=</span> <span class="n">charge</span><span class="p">[</span><span class="n">iindex</span><span class="p">]</span>

        <span class="n">H</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">Ec</span> <span class="o">*</span> <span class="p">(</span><span class="n">nmat</span> <span class="o">-</span> <span class="n">ng</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">EJ</span> <span class="o">*</span> <span class="n">V</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">H</span><span class="p">)))):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Matrix is not Hermitian&#39;</span><span class="p">)</span>

        <span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
        <span class="n">sortIX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">sorted_d</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">sortIX</span><span class="p">]</span>

        <span class="n">elvls</span><span class="p">[:,</span> <span class="n">iindex</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sorted_d</span> <span class="o">-</span> <span class="n">sorted_d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">do_plots</span><span class="p">:</span>

        <span class="c1"># plot using matplotlib (might need to clean this up)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">charge</span><span class="p">,</span>
                 <span class="n">elvls</span><span class="p">[</span>
                     <span class="mi">0</span><span class="p">,</span>
                 <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">,</span>
                 <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                 <span class="n">charge</span><span class="p">,</span>
                 <span class="n">elvls</span><span class="p">[</span>
                     <span class="mi">1</span><span class="p">,</span>
                 <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">,</span>
                 <span class="s1">&#39;b&#39;</span><span class="p">,</span>
                 <span class="n">charge</span><span class="p">,</span>
                 <span class="n">elvls</span><span class="p">[</span>
                     <span class="mi">2</span><span class="p">,</span>
                 <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">,</span>
                 <span class="s1">&#39;r&#39;</span><span class="p">,</span>
                 <span class="n">charge</span><span class="p">,</span>
                 <span class="n">elvls</span><span class="p">[</span>
                     <span class="mi">3</span><span class="p">,</span>
                 <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">,</span>
                 <span class="s1">&#39;g&#39;</span><span class="p">,</span>
                 <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Gate charge, n_g [2e]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy, E_n [GHz]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">charge</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">elvls</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">+</span> <span class="n">elvls</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Gate charge, n_g [2e]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy [kHz], &#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">charge</span><span class="p">,</span> <span class="mi">1000</span> <span class="o">*</span> <span class="p">(</span><span class="n">elvls</span><span class="p">[</span>
                <span class="mi">2</span><span class="p">,</span>
            <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span> <span class="o">-</span> <span class="n">elvls</span><span class="p">[</span>
                <span class="mi">0</span><span class="p">,</span>
            <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">elvls</span><span class="p">[</span>
                <span class="mi">1</span><span class="p">,</span>
            <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span> <span class="o">-</span> <span class="n">elvls</span><span class="p">[</span>
                <span class="mi">0</span><span class="p">,</span>
            <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">),</span> <span class="n">charge</span><span class="p">,</span> <span class="o">-</span><span class="n">charge</span> <span class="o">*</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">Ec</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Gate charge, n_g [2e]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;delta [MHZ] green theory, blue numerics &#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">charge</span><span class="p">,</span> <span class="n">elvls</span><span class="p">[</span>
            <span class="mi">1</span><span class="p">,</span>
        <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span> <span class="o">-</span> <span class="n">elvls</span><span class="p">[</span>
            <span class="mi">0</span><span class="p">,</span>
        <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">,</span> <span class="n">charge</span><span class="p">,</span> <span class="n">charge</span> <span class="o">*</span> <span class="mi">0</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">EJ</span> <span class="o">*</span> <span class="n">Ec</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ec</span><span class="p">)</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Gate charge, n_g [2e]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;F01 [GHZ] green theory, blue numerics &#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">fqubitGHz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">elvls</span><span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">)</span>
    <span class="n">anharMHz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="p">(</span><span class="n">elvls</span><span class="p">[</span>
        <span class="mi">2</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span> <span class="o">-</span> <span class="n">elvls</span><span class="p">[</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">elvls</span><span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span> <span class="o">-</span> <span class="n">elvls</span><span class="p">[</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">))</span>

    <span class="n">disp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="o">-</span><span class="n">elvls</span><span class="p">[</span>
        <span class="mi">1</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">/</span> <span class="n">h</span> <span class="o">+</span> <span class="n">elvls</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">tphi_ms</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">disp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1e-4</span> <span class="o">*</span> <span class="mf">1e-3</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">do_disp</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Frequency </span><span class="si">%f</span><span class="s1"> [GHz]&#39;</span> <span class="o">%</span> <span class="n">fqubitGHz</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Anharmonicity </span><span class="si">%f</span><span class="s1"> [MHz]&#39;</span> <span class="o">%</span> <span class="n">anharMHz</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;EC </span><span class="si">%f</span><span class="s1"> [GHz]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Ec</span> <span class="o">/</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Charge Dispersion </span><span class="si">%f</span><span class="s1"> [kHz]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">disp</span> <span class="o">/</span> <span class="mf">1e3</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dephasing Time </span><span class="si">%f</span><span class="s1"> [ms]&#39;</span> <span class="o">%</span> <span class="n">tphi_ms</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fqubitGHz</span><span class="p">,</span> <span class="n">anharMHz</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="n">tphi_ms</span></div>



<div class="viewcode-block" id="get_C_and_Ic">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.get_C_and_Ic">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_C_and_Ic</span><span class="p">(</span><span class="n">Cin_est</span><span class="p">,</span> <span class="n">Icin_est</span><span class="p">,</span> <span class="n">f01</span><span class="p">,</span> <span class="n">f02on2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the capacitance and critical current for a transmon of a certain</span>
<span class="sd">    frequency and anharmonicity.</span>

<span class="sd">    Args:</span>
<span class="sd">        Cin_est (float): Initial guess for capacitance (in fF)</span>
<span class="sd">        Icin_est (float): Initial guess for critical current (in nA)</span>
<span class="sd">        f01 (float): Transmon frequency (in GHz)</span>
<span class="sd">        f02on2 (float): 02/2 frequency (in GHz)</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: [C,Ic] from levels_vs_ng_real_units that gives the</span>
<span class="sd">        specified frequency and anharmonicity</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xrr</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">cos_to_mega_and_delta</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">f01</span><span class="p">,</span> <span class="n">f02on2</span><span class="p">),</span>
                       <span class="p">[</span><span class="n">Cin_est</span><span class="p">,</span> <span class="n">Icin_est</span><span class="p">],</span>
                       <span class="n">tol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
                       <span class="n">options</span><span class="o">=</span><span class="p">{</span>
                           <span class="s1">&#39;maxiter&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                           <span class="s1">&#39;disp&#39;</span><span class="p">:</span> <span class="kc">True</span>
                       <span class="p">})</span>

    <span class="k">return</span> <span class="n">xrr</span><span class="o">.</span><span class="n">x</span></div>



<span class="c1">########################################################################</span>
<span class="c1"># Utility functions for reporting and loading - Zlatko</span>


<span class="c1"># Cost function for calculating C and IC</span>
<span class="c1"># given a C and IC calculate f and f02/2 from &#39;levels_vs_ng_real_units&#39;</span>
<span class="c1"># and least square with measured f01,f02on2</span>
<div class="viewcode-block" id="cos_to_mega_and_delta">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.cos_to_mega_and_delta">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">cos_to_mega_and_delta</span><span class="p">(</span><span class="n">Cin</span><span class="p">,</span> <span class="n">ICin</span><span class="p">,</span> <span class="n">f01</span><span class="p">,</span> <span class="n">f02on2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cost function for calculating C and IC given a C and IC calculate f and</span>
<span class="sd">    f02/2 from &#39;levels_vs_ng_real_units&#39; and least square with measured</span>
<span class="sd">    f01,f02on2.</span>

<span class="sd">    Args:</span>
<span class="sd">        Cin (float): Cin</span>
<span class="sd">        ICin (float): ICin</span>
<span class="sd">        f01 (float): f01</span>
<span class="sd">        f02on2 (float): f02on2</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Calculated value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fqubitGHz</span><span class="p">,</span> <span class="n">anharMHz</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="n">tphi_ms</span> <span class="o">=</span> <span class="n">levels_vs_ng_real_units</span><span class="p">(</span><span class="n">Cin</span><span class="p">,</span>
                                                                 <span class="n">ICin</span><span class="p">,</span>
                                                                 <span class="n">N</span><span class="o">=</span><span class="mi">51</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">fqubitGHz</span> <span class="o">-</span> <span class="n">f01</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
            <span class="p">(</span><span class="n">fqubitGHz</span> <span class="o">+</span> <span class="n">anharMHz</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">/</span> <span class="mf">1e3</span> <span class="o">-</span> <span class="n">f02on2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span></div>



<span class="c1"># TODO: Move to a more generic file</span>


<div class="viewcode-block" id="chargeline_T1">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.chargeline_T1">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">chargeline_T1</span><span class="p">(</span><span class="n">Ccharge</span><span class="p">,</span> <span class="n">Cq</span><span class="p">,</span> <span class="n">f01</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the charge line `T1`.</span>

<span class="sd">    Args:</span>
<span class="sd">        Cchare (float): Ccharge</span>
<span class="sd">        Cq (float): Cq</span>
<span class="sd">        f01 (float): f01</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Calculated chargeline T1</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">Cq</span> <span class="o">/</span> <span class="p">(</span><span class="n">Ccharge</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">50.</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f01</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>



<span class="c1"># TODO: Move to a more generic file</span>


<div class="viewcode-block" id="readin_q3d_matrix">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.readin_q3d_matrix">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">readin_q3d_matrix</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read in the txt file created from q3d export as CSV and output the</span>
<span class="sd">    capacitance matrix file exported by Ansys Q3D.</span>

<span class="sd">    When exporting pick &quot;save as type: data table&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): Path to file</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: df_cmat, units, design_variation, df_cond</span>

<span class="sd">    Example file:</span>

<span class="sd">    ::</span>

<span class="sd">        DesignVariation:$BBoxL=&#39;650um&#39; $boxH=&#39;750um&#39; $boxL=&#39;2mm&#39; $QubitGap=&#39;30um&#39; $QubitH=&#39;90um&#39; $QubitL=&#39;450um&#39; Lj_1=&#39;13nH&#39;</span>
<span class="sd">        Setup1:LastAdaptive</span>
<span class="sd">        Problem Type:C</span>
<span class="sd">        C Units:farad, G Units:mSie</span>
<span class="sd">        Reduce Matrix:Original</span>
<span class="sd">        Frequency: 5.5E+09 Hz</span>

<span class="sd">        Capacitance Matrix</span>
<span class="sd">            ground_plane        Q1_bus_Q0_connector_pad Q1_bus_Q2_connector_pad Q1_pad_bot      Q1_pad_top1     Q1_readout_connector_pad</span>
<span class="sd">        ground_plane    2.8829E-13      -3.254E-14      -3.1978E-14     -4.0063E-14     -4.3842E-14     -3.0053E-14</span>
<span class="sd">        Q1_bus_Q0_connector_pad -3.254E-14      4.7257E-14      -2.2765E-16     -1.269E-14      -1.3351E-15     -1.451E-16</span>
<span class="sd">        Q1_bus_Q2_connector_pad -3.1978E-14     -2.2765E-16     4.5327E-14      -1.218E-15      -1.1552E-14     -5.0414E-17</span>
<span class="sd">        Q1_pad_bot      -4.0063E-14     -1.269E-14      -1.218E-15      9.5831E-14      -3.2415E-14     -8.3665E-15</span>
<span class="sd">        Q1_pad_top1     -4.3842E-14     -1.3351E-15     -1.1552E-14     -3.2415E-14     9.132E-14       -1.0199E-15</span>
<span class="sd">        Q1_readout_connector_pad        -3.0053E-14     -1.451E-16      -5.0414E-17     -8.3665E-15     -1.0199E-15     3.9884E-14</span>

<span class="sd">        Conductance Matrix</span>
<span class="sd">            ground_plane        Q1_bus_Q0_connector_pad Q1_bus_Q2_connector_pad Q1_pad_bot      Q1_pad_top1     Q1_readout_connector_pad</span>
<span class="sd">        ground_plane    0       0       0       0       0       0</span>
<span class="sd">        Q1_bus_Q0_connector_pad 0       0       0       0       0       0</span>
<span class="sd">        Q1_bus_Q2_connector_pad 0       0       0       0       0       0</span>
<span class="sd">        Q1_pad_bot      0       0       0       0       0       0</span>
<span class="sd">        Q1_pad_top1     0       0       0       0       0       0</span>
<span class="sd">        Q1_readout_connector_pad        0       0       0       0       0       0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">text</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>

    <span class="n">s1</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;Capacitance Matrix&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Copuld not split text to `Capacitance Matrix`&quot;</span>

    <span class="n">s2</span> <span class="o">=</span> <span class="n">s1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;Conductance Matrix&#39;</span><span class="p">)</span>

    <span class="n">df_cmat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                          <span class="n">delim_whitespace</span><span class="o">=</span><span class="n">delim_whitespace</span><span class="p">,</span>
                          <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">df_cond</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                              <span class="n">delim_whitespace</span><span class="o">=</span><span class="n">delim_whitespace</span><span class="p">,</span>
                              <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df_cond</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">delim_whitespace</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_cmat</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="n">df_cmat</span> <span class="o">=</span> <span class="n">df_cmat</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df_cmat</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">units</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C Units:(.*?),&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">design_variation</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;DesignVariation:(.*?)\n&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">design_variation</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">design_variation</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Design Variation:(.*?)\n&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">design_variation</span><span class="p">:</span>
            <span class="n">design_variation</span> <span class="o">=</span> <span class="n">design_variation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">design_variation</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">design_variation</span> <span class="o">=</span> <span class="n">design_variation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df_cmat</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">design_variation</span><span class="p">,</span> <span class="n">df_cond</span></div>



<div class="viewcode-block" id="readin_q3d_matrix_m">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.readin_q3d_matrix_m">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">readin_q3d_matrix_m</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read in Q3D cap matrix from a .m file exported by Ansys Q3d.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): Path to .m file</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame of cap matrix, with no names of columns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;capMatrix (.*?)]&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;= [&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">dfC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">match</span><span class="p">),</span>
                          <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfC</span></div>



<span class="c1"># TODO: Move to a more generic file</span>


<div class="viewcode-block" id="load_q3d_capacitance_matrix">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.load_q3d_capacitance_matrix">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">load_q3d_capacitance_matrix</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">user_units</span><span class="o">=</span><span class="s1">&#39;fF&#39;</span><span class="p">,</span> <span class="n">_disp</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load Q3D capcitance file exported as Maxwell matrix. Do not export</span>
<span class="sd">    conductance. Units are read in automatically and converted to user units.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): Path to file.</span>
<span class="sd">        user_units (str): Units.  Defaults to &#39;fF&#39;.</span>
<span class="sd">        _disp (bool): whehter or not to display messages.  Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tupe: df_cmat, user_units, design_variation, df_cond</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df_cmat</span><span class="p">,</span> <span class="n">Cunits</span><span class="p">,</span> <span class="n">design_variation</span><span class="p">,</span> <span class="n">df_cond</span> <span class="o">=</span> <span class="n">readin_q3d_matrix</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="c1"># Unit convert</span>
    <span class="n">ureg</span> <span class="o">=</span> <span class="n">UnitRegistry</span><span class="p">()</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">parse_expression</span><span class="p">(</span><span class="n">Cunits</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">user_units</span><span class="p">)</span>
    <span class="n">df_cmat</span> <span class="o">=</span> <span class="n">df_cmat</span> <span class="o">*</span> <span class="n">q</span><span class="o">.</span><span class="n">magnitude</span>  <span class="c1"># scale to user units</span>

    <span class="c1"># Report</span>
    <span class="k">if</span> <span class="n">_disp</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Imported capacitance matrix with UNITS: [</span><span class="si">%s</span><span class="s2">] now converted to USER UNITS:[</span><span class="si">%s</span><span class="s2">] </span><span class="se">\</span>
<span class="s2">                from file:</span><span class="se">\n\t</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Cunits</span><span class="p">,</span> <span class="n">user_units</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>
        <span class="n">df_cmat_style_print</span><span class="p">(</span><span class="n">df_cmat</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_cmat</span><span class="p">,</span> <span class="n">user_units</span><span class="p">,</span> <span class="n">design_variation</span><span class="p">,</span> <span class="n">df_cond</span></div>



<div class="viewcode-block" id="lumped_oscillator_from_path">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.lumped_oscillator_from_path">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lumped_oscillator_from_path</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Lj_nH</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Cj_fF</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">N</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                                <span class="n">fr</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
                                <span class="n">fb</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtain a single result dataframe from a Q3D capacitance file pointed to by path.</span>
<span class="sd">    Similar to member method lumped_oscillator_vs_passes() of QQ3DRenderer but for a user</span>
<span class="sd">    provided capacitance matrix file.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): Path to file.</span>
<span class="sd">        Lj_nH (float): Junction inductance (in nH)</span>
<span class="sd">        Cj_fF (float): Junction capacitance (in fF)</span>
<span class="sd">        N (int): Coupling pads (1 readout, N - 1 bus)</span>
<span class="sd">        fr (Union[list, float]):Readout frequencies (in GHz). fr can be a list with the order</span>
<span class="sd">            they appear in the capMatrix.</span>
<span class="sd">        fb (Union[list, float]): Coupling bus frequencies (in GHz). fb can be a list with the order</span>
<span class="sd">            they appear in the capMatrix.</span>
<span class="sd">        g_scale (float, optional): Scale factor. Defaults to 1..</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A single dataframe corresponding to a single capacitance matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ureg</span> <span class="o">=</span> <span class="n">UnitRegistry</span><span class="p">()</span>
    <span class="n">IC_Amps</span> <span class="o">=</span> <span class="n">Convert</span><span class="o">.</span><span class="n">Ic_from_Lj</span><span class="p">(</span><span class="n">Lj_nH</span><span class="p">,</span> <span class="s1">&#39;nH&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
    <span class="n">CJ</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Cj_fF</span><span class="si">}</span><span class="s1"> fF&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;farad&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fr</span><span class="si">}</span><span class="s1"> GHz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;GHz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span>
    <span class="n">fb</span> <span class="o">=</span> <span class="p">[</span><span class="n">ureg</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s1"> GHz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;GHz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span> <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">fb</span><span class="p">]</span>

    <span class="n">df_cmat</span><span class="p">,</span> <span class="n">user_units</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="o">=</span> <span class="n">load_q3d_capacitance_matrix</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">c_units</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">(</span><span class="n">user_units</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;farads&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span>

    <span class="n">RES</span> <span class="o">=</span> <span class="n">extract_transmon_coupled_Noscillator</span><span class="p">(</span><span class="n">df_cmat</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">c_units</span><span class="p">,</span>
                                               <span class="n">IC_Amps</span><span class="p">,</span>
                                               <span class="n">CJ</span><span class="p">,</span>
                                               <span class="n">N</span><span class="p">,</span>
                                               <span class="n">fb</span><span class="p">,</span>
                                               <span class="n">fr</span><span class="p">,</span>
                                               <span class="n">g_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                               <span class="n">print_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">RES</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">RES</span><span class="p">])</span>
    <span class="n">RES</span><span class="p">[</span><span class="s1">&#39;χr MHz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">RES</span><span class="p">[</span><span class="s1">&#39;chi_in_MHz&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">RES</span><span class="p">[</span><span class="s1">&#39;gr MHz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">RES</span><span class="p">[</span><span class="s1">&#39;gbus&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">RES</span></div>



<div class="viewcode-block" id="df_cmat_style_print">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.df_cmat_style_print">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">df_cmat_style_print</span><span class="p">(</span><span class="n">df_cmat</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Display the dataframe in the cmat style.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_cmat (dataframe): Dataframe to display</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
    <span class="n">display</span><span class="p">(</span><span class="n">df_cmat</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#5fba7d&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span></div>



<span class="c1">########################################################################</span>
<span class="c1"># Utility functions - Zlatko</span>


<div class="viewcode-block" id="move_index_to">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.move_index_to">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">move_index_to</span><span class="p">(</span><span class="n">i_from</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">i_to</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">len_</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Utility function to swap index.</span>

<span class="sd">    Args:</span>
<span class="sd">        i_from (int): Data frame to swap index</span>
<span class="sd">        i_to (int): Data frame to index</span>
<span class="sd">        len_ (int): Length of array</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: list of indecies, such as  array([1, 2, 3, 4, 0, 5])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_</span><span class="p">)</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">idxs</span><span class="p">,</span> <span class="n">i_from</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">idxs</span><span class="p">,</span> <span class="n">i_to</span><span class="p">,</span> <span class="n">i_from</span><span class="p">)</span></div>



<span class="c1"># TODO: Move to a more generic file</span>


<div class="viewcode-block" id="df_reorder_matrix_basis">
<a class="viewcode-back" href="../../../../apidocs/qiskit_metal.analyses.lumped_capacitive.html#qiskit_metal.analyses.lumped_capacitive.df_reorder_matrix_basis">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">df_reorder_matrix_basis</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">i_from</span><span class="p">,</span> <span class="n">i_to</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Data frame handle reording of matrix basis.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (DataFrame): Data frame to swap</span>
<span class="sd">        i_from (int): Index to move from</span>
<span class="sd">        i_to (int): Index to move to</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame: The changed index DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">move_index_to</span><span class="p">(</span><span class="n">i_from</span><span class="p">,</span> <span class="n">i_to</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">idx</span><span class="p">)]</span>
    <span class="c1"># Maybe make copy</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span></div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Quantum Metal Community; 2019-2025 Qiskit Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 2025/12/11</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js?v=8e576371"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>