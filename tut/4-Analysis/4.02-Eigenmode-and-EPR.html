<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Impedance, admittance and scattering analysis" href="4.03-Impedance.html" /><link rel="prev" title="Capacitance matrix and LOM analysis" href="4.01-Capacitance-and-LOM.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.01.29 -->
        <title>Eigenmode and EPR analysis - Qiskit Metal 0.1.5 0.1.5</title>
      <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/qiskit-sphinx-theme.css?v=fe84956c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/qiskit-ecosystem.css?v=745c5aa7" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=IBM+Plex+Sans:ital,wght@0,400;0,600;1,400;1,600&display=swap" rel="stylesheet">
<script src="../../_static/js/web-components/top-nav-bar.js"></script></head>
  <body>
    
    <script>document.body.dataset.theme = "light";</script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <defs><style>.cls-1{fill:none;}</style></defs>
      <path d="M28,4H4A2,2,0,0,0,2,6V26a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V6A2,2,0,0,0,28,4ZM4,6H20V26H4ZM28,26H22V6h6Z"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <defs><style>.cls-1{fill:none;}</style></defs>
      <rect x="4" y="6" width="24" height="2"/>
      <rect x="4" y="24" width="24" height="2"/>
      <rect x="4" y="12" width="24" height="2"/>
      <rect x="4" y="18" width="24" height="2"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg version="1.1" id="icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
         viewBox="0 0 32 32" style="enable-background:new 0 0 32 32;" xml:space="preserve"><polygon points="22,16 12,26 10.6,24.6 19.2,16 10.6,7.4 12,6 " stroke="currentColor"/>
      <rect id="_x3C_Transparent_Rectangle_x3E_" fill="none" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-new-tab" viewBox="0 0 32 32">
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
      <defs>
        <style>
          .cls-1 {
            fill: none;
          }
        </style>
      </defs>
      <path fill="#6929C4" d="M26,28H6a2.0027,2.0027,0,0,1-2-2V6A2.0027,2.0027,0,0,1,6,4H16V6H6V26H26V16h2V26A2.0027,2.0027,0,0,1,26,28Z"/>
      <polygon fill="#6929C4" points="20 2 20 4 26.586 4 18 12.586 19.414 14 28 5.414 28 12 30 12 30 2 20 2"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Qiskit Metal 0.1.5 0.1.5</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-brand">
  <a href="https://www.qiskit.org/ecosystem">
    <div class="sidebar-logo-container">
      <img class="sidebar-logo" src="../../_static/images/ecosystem-logo.svg" alt="Qiskit Ecosystem logo"/>
    </div>
  </a>
  
  <span class="sidebar-brand-text">Qiskit Metal 0.1.5 0.1.5</span>
</div><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installing Qiskit Metal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflow.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflow.html#qiskit-metal-workflow">Qiskit Metal Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflow.html#quantization-methods-overview">Quantization Methods Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributor Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributor-guide.html">Contributing to Qiskit Metal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributor-guide.html#where-things-are">Where Things Are</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributor-guide.html#reporting-bugs-and-requesting-enhancements">Reporting Bugs and Requesting Enhancements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributor-guide.html#contributing-code">Contributing Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributor-guide.html#contributing-to-documentation">Contributing to Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../index.html">Overview</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Overview</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1-Overview/1.1-Bird%27s-eye-view-of-Qiskit-Metal.html">Bird’s eye view of Qiskit Metal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-Overview/1.1-Bird%27s-eye-view-of-Qiskit-Metal.html#Coding-Time!">Coding Time!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-Overview/1.2-Quick-start.html">Quick start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1-Overview/1.3-Saving-Your-Chip-Design.html">Save your chip design</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../index.html#components">Components</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Components</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.01-How-to-use-a-QComponent.html">How to use a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#QComponent-Default-Options">QComponent Default Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Modifying-the-Options">Modifying the Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Copying-a-QComponent">Copying a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Deleting-a-QComponent">Deleting a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Renaming-a-QComponent">Renaming a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Overwriting-a-QComponent">Overwriting a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.01-How-to-use-a-QComponent.html#Closing-the-Qiskit-Metal-GUI">Closing the Qiskit Metal GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.02-How-to-copy-a-QComponent.html">How to copy a QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.11-Routing-101.html">Routing 101</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.12-Simple-Meander.html">Simple Meander</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.12-Simple-Meander.html#Using-CPW-meanders-to-connect-the-3-Qbits">Using CPW meanders to connect the 3 Qbits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.13-Hybrid-Auto-and-AStar.html">Hybrid Auto and AStar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.14-Get-them-all-with-MixedRoute.html">Get them all with MixedRoute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.21-Design-a-4-qubit-full-chip.html">Design a 4 qubit full chip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.22-Design-100-qubits-programmatically.html">Design 100 qubits programmatically</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.23-Modify-chip-options.html">Modify chip options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.31-Create-a-QComponent-Basic.html">Create a QComponent - Basic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.32-Create-a-QComponent-Advanced.html">Create a QComponent - Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2-From-components-to-chip/2.33-Add-my-QComponent-to-a-reusable-python-file.html">Add my QComponent to a reusable python file</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../index.html#renderers">Renderers</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Renderers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../3-Renderers/3.1-Introduction-to-QRenderers.html">Introduction to QRenderers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3-Renderers/3.1-Introduction-to-QRenderers.html#Note:">Note:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3-Renderers/3.2-Export-your-design-to-GDS.html">Export your design to GDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3-Renderers/3.3-Render-your-design-to-Ansys.html">Render your design to Ansys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3-Renderers/3.4-How-do-I-make-my-custom-QRenderer.html">How do I make my custom QRenderer</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html#analysis">Analysis</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Analysis</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="4.01-Capacitance-and-LOM.html">Capacitance matrix and LOM analysis</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Eigenmode and EPR analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#1.-Analyze-the-transmon-qubit-by-itself">1. Analyze the transmon qubit by itself</a></li>
<li class="toctree-l2"><a class="reference internal" href="#2.-Analyze-the-CPW-resonator-by-itself">2. Analyze the CPW resonator by itself</a></li>
<li class="toctree-l2"><a class="reference internal" href="#3.-Analyze-the-combined-transmon-+-CPW-resonator-system">3. Analyze the combined transmon + CPW resonator system</a></li>
<li class="toctree-l2"><a class="reference internal" href="#4.-Analyze-a-coupled-2-transmon-system">4. Analyze a coupled 2-transmon system</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.03-Impedance.html">Impedance, admittance and scattering analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.11-Analyze-and-tune-a-transmon.html">Analyzing and tuning a transmon qubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.11-Analyze-and-tune-a-transmon.html#1.-Create-the-Qbit-design">1. Create the Qbit design</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.11-Analyze-and-tune-a-transmon.html#2.-Analyze-the-transmon-using-the-Eigenmode-EPR-method">2. Analyze the transmon using the Eigenmode-EPR method</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.11-Analyze-and-tune-a-transmon.html#3.-Analyze-the-transmon-using-the-LOM-method">3. Analyze the transmon using the LOM method</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.12-Analyze-a-resonator.html">Analyzing and tuning a resonator</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.12-Analyze-a-resonator.html#1.-Create-the-Resonator-design">1. Create the Resonator design</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.12-Analyze-a-resonator.html#2.-Analyze-the-resonator-using-the-Eigenmode-EPR-method">2. Analyze the resonator using the Eigenmode-EPR method</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.13-Analyze-transmon-and-resonator.html">Analyzing and tuning a transmon qubit with a resonator</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.13-Analyze-transmon-and-resonator.html#1.-Create-the-Qbit-design">1. Create the Qbit design</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.13-Analyze-transmon-and-resonator.html#2.-Analyze-the-transmon-&amp;-resonator-using-the-Eigenmode-EPR-method">2. Analyze the transmon &amp; resonator using the Eigenmode-EPR method</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.13-Analyze-transmon-and-resonator.html#3.-Analyze-the-transmon-using-the-LOM-method">3. Analyze the transmon using the LOM method</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.14-Analyze-a-double-hanger-resonator.html">Analyzing a double hanger resonator (S Param)</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.15-CPW-kappa-calculation.html">CPW Kappa Calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.21-Capacitance-matrix.html">Sweeps - Capacitance matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.21-Capacitance-matrix.html#READ-THIS-BEFORE-running-the-cell.">READ THIS BEFORE running the cell.</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.22-Eigenmode-matrix.html">Sweeps - Eigenmode matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.23-Impedance-and-scattering-Z-S-Y-matrices.html">Sweeps - Impedance, scattering and admittance (Z S Y) matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.31-Plot-quantum-oscillator-wavefunction.html">Plotting Wavefunctions of the Quantum Harmonic Oscillator (LC Circuit)</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.32-Transmon-analytics-HCPB.html">Transmon Analytics: Plotting Eigenvalues as a Function of Offset Charge</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.33-Transmon-analytics.html">Transmon Analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.34-Transmon-qubit-CPB-hamiltonian-charge-basis.html">Modeling transmon qubit Cooper-pair box Hamiltonian in the charge basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.34-Transmon-qubit-CPB-hamiltonian-charge-basis.html#Additional-Analysis:-Charge-Dispersion,-Energy-Level-Differences,-Anharmonicity-and-Dephasing-Time-(T2)">Additional Analysis: Charge Dispersion, Energy Level Differences, Anharmonicity and Dephasing Time (T2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.34-Transmon-qubit-CPB-hamiltonian-charge-basis.html#Qutip-simulation">Qutip simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.34-Transmon-qubit-CPB-hamiltonian-charge-basis.html#Experimental">Experimental</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.34-Transmon-qubit-CPB-hamiltonian-charge-basis.html#New-section-on-integrating-sc_qubits.">New section on integrating sc_qubits.</a></li>
<li class="toctree-l2"><a class="reference internal" href="4.34-Transmon-qubit-CPB-hamiltonian-charge-basis.html#Transmon-and-the-Oscillator">Transmon and the Oscillator</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../index.html#quick-topics">Quick Topics</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Quick Topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../quick-topics/JJ-Demo-Notebook.html">Josephson Junction QComponent Demo Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-topics/Managing-pins.html">Managing pins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-topics/Managing-variables.html">Managing variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-topics/Opening-documentation.html">Opening the documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-topics/QComponent-3-fingers-capacitor.html">QComponent - 3-fingers capacitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-topics/QComponent-Interdigitated-transmon.html">QComponent - Interdigitated transmon qubit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://www.youtube.com/playlist?list=PLOFEBzvs-VvqHl5ZqVmhB_FcSqmLufsjb">Video Recordings</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Circuit Example Library</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../circuit-examples/index.html">Qubits</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Qubits</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/01-Transmon_cross.html">Single Transmon - Grounded (xmon)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/02-Transmon_floating.html">Single Transmon - Floating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/03-concentric_transmon.html">Concentric Transmon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/04-Interdigitated_Transmon.html">Interdigitated Transmon Qubits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/05-Transmon_cross_fl.html">Single Transmon - Grounded (xmon) flux lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/06-Transmon_floating_6.html">Single Transmon - Floating with 6 connection pads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/07-Transmon_floating_cl.html">Single Transmon - Floating with charge lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/08-JJ-Dolan.html">Josephson Junction (Dolan)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/09-JJ-Manhattan.html">Josephson Junction (Manhattan)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/10-Transmon_floating_teeth.html">Single Transmon - Floating with teeth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/11-Star_shaped_qubit.html">Star shaped qubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/11-Star_shaped_qubit.html#A-Star-Qubit">A Star Qubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/A.Qubits/11-Star_shaped_qubit.html#Closing-the-Qiskit-Metal-GUI">Closing the Qiskit Metal GUI</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../circuit-examples/index.html#resonators">Resonators</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Resonators</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/B.Resonators/11-Resonator_Meander.html">Simple CPW Meander</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../circuit-examples/index.html#composite-bi-partite-systems">Composite Bi-Partite Systems</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Composite Bi-Partite Systems</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/C.Composite-bi-partite/21-OneTransmonsWithMeanderAndOTG.html">Transmon coupled to CPW resonator</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../circuit-examples/index.html#qubit-couplers">Qubit Couplers</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Qubit Couplers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/D.Qubit-couplers/31-TwoCrossmonsTunableCoupler.html">Tunable Coupler (MIT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/D.Qubit-couplers/32-TwoTransmonsDirectCoupling.html">Direct Coupler (transmon-transmon)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/D.Qubit-couplers/33-TwoTransmonsWithMeander.html">Bus Resonator Coupler (transmon-transmon)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../circuit-examples/index.html#input-output-coupling">Input-Output Coupling</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Input-Output Coupling</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/E.Input-output-coupling/41-LaunchPad.html">CPW Launch Pad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/E.Input-output-coupling/42-ResonatorAndLaunchPad.html">Readout line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/E.Input-output-coupling/43-TransmonPocketCL.html">Charge Line</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../circuit-examples/index.html#small-quantum-chips">Small Quantum Chips</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Small Quantum Chips</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/F.Small-quantum-chips/51-Four_qubit_chip.html">Four Qubit Chip Design</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../circuit-examples/index.html#design-flow">Design Flow</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Design Flow</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/full-design-flow-examples/Example-full-chip-design.html">Example full chip design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/full-design-flow-examples/Example-full-chip-design.html#Layout">Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/full-design-flow-examples/Example-full-chip-design.html#Analyze">Analyze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/full-design-flow-examples/Example-used-in-the-launch-video.html">Launch Videos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../circuit-examples/full-design-flow-examples/Exercise-for-the-South-Korea-Hackathon%2720.html">South Korea Qiskit Hackathon’20 - Qiskit Metal exercise</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Libraries</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../apidocs/qlibrary.html">All Quantum Devices</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of All Quantum Devices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.QComponent.html">QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.ParsedDynamicAttributes_Component.html">ParsedDynamicAttributes_Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.BaseQubit.html">BaseQubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.QRoute.html">QRoute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.QRouteLead.html">QRouteLead</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.QRoutePoint.html">QRoutePoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.CircleCaterpillar.html">CircleCaterpillar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.CircleRaster.html">CircleRaster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.NGon.html">NGon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.NSquareSpiral.html">NSquareSpiral</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.Rectangle.html">Rectangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RectangleHollow.html">RectangleHollow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.Cap3Interdigital.html">Cap3Interdigital</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.CapNInterdigital.html">CapNInterdigital</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.ResonatorCoilRect.html">ResonatorCoilRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.CoupledLineTee.html">CoupledLineTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.LineTee.html">LineTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.CapNInterdigitalTee.html">CapNInterdigitalTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TunableCoupler01.html">TunableCoupler01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TunableCoupler02.html">TunableCoupler02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.ReadoutResFC.html">ReadoutResFC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.ResonatorLumped.html">ResonatorLumped</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebond.html">LaunchpadWirebond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebondCoupled.html">LaunchpadWirebondCoupled</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebondDriven.html">LaunchpadWirebondDriven</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.OpenToGround.html">OpenToGround</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.ShortToGround.html">ShortToGround</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RouteStraight.html">RouteStraight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RouteFramed.html">RouteFramed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RouteMeander.html">RouteMeander</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RouteAnchors.html">RouteAnchors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RouteMixed.html">RouteMixed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RoutePathfinder.html">RoutePathfinder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.jj_dolan.html">jj_dolan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.jj_manhattan.html">jj_manhattan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonConcentric.html">TransmonConcentric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonConcentricType2.html">TransmonConcentricType2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonCross.html">TransmonCross</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonCrossFL.html">TransmonCrossFL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonInterdigitated.html">TransmonInterdigitated</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonPocket.html">TransmonPocket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonPocketCL.html">TransmonPocketCL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonPocket6.html">TransmonPocket6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonPocketTeeth.html">TransmonPocketTeeth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TunableCoupler01.html">TunableCoupler01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.SQUID_LOOP.html">SQUID_LOOP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.StarQubit.html">StarQubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.anchored_path.html">anchored_path</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../apidocs/designs.html">QDesigns</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of QDesigns</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.designs.QDesign.html">QDesign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.designs.DesignPlanar.html">DesignPlanar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.designs.MultiPlanar.html">MultiPlanar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.designs.DesignFlipChip.html">DesignFlipChip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.designs.QNet.html">QNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.designs.Components.html">Components</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../apidocs/qlibrary.html">QComponents</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of QComponents</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.QComponent.html">QComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.ParsedDynamicAttributes_Component.html">ParsedDynamicAttributes_Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.BaseQubit.html">BaseQubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.QRoute.html">QRoute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.QRouteLead.html">QRouteLead</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qlibrary.QRoutePoint.html">QRoutePoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.CircleCaterpillar.html">CircleCaterpillar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.CircleRaster.html">CircleRaster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.NGon.html">NGon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.NSquareSpiral.html">NSquareSpiral</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.Rectangle.html">Rectangle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RectangleHollow.html">RectangleHollow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.Cap3Interdigital.html">Cap3Interdigital</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.CapNInterdigital.html">CapNInterdigital</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.ResonatorCoilRect.html">ResonatorCoilRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.CoupledLineTee.html">CoupledLineTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.LineTee.html">LineTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.CapNInterdigitalTee.html">CapNInterdigitalTee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TunableCoupler01.html">TunableCoupler01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TunableCoupler02.html">TunableCoupler02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.ReadoutResFC.html">ReadoutResFC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.ResonatorLumped.html">ResonatorLumped</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebond.html">LaunchpadWirebond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebondCoupled.html">LaunchpadWirebondCoupled</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.LaunchpadWirebondDriven.html">LaunchpadWirebondDriven</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.OpenToGround.html">OpenToGround</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.ShortToGround.html">ShortToGround</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RouteStraight.html">RouteStraight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RouteFramed.html">RouteFramed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RouteMeander.html">RouteMeander</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RouteAnchors.html">RouteAnchors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RouteMixed.html">RouteMixed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.RoutePathfinder.html">RoutePathfinder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.jj_dolan.html">jj_dolan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.jj_manhattan.html">jj_manhattan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonConcentric.html">TransmonConcentric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonConcentricType2.html">TransmonConcentricType2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonCross.html">TransmonCross</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonCrossFL.html">TransmonCrossFL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonInterdigitated.html">TransmonInterdigitated</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonPocket.html">TransmonPocket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonPocketCL.html">TransmonPocketCL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonPocket6.html">TransmonPocket6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TransmonPocketTeeth.html">TransmonPocketTeeth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.TunableCoupler01.html">TunableCoupler01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.SQUID_LOOP.html">SQUID_LOOP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.StarQubit.html">StarQubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.qlibrary.anchored_path.html">anchored_path</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../apidocs/analyses.html">Analyses</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Analyses</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.QAnalysis.html">QAnalysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.QSimulation.html">QSimulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.Hcpb.html">Hcpb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.Hcpb_analytic.html">Hcpb_analytic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.HO_wavefunctions.html">HO_wavefunctions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.transmon_analytics.html">transmon_analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.cpw_calculations.html">cpw_calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.kappa_calculation.html">kappa_calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.Sweeper.html">Sweeper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.LOManalysis.html">LOManalysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.EPRanalysis.html">EPRanalysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.lumped_capacitive.html">lumped_capacitive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.LumpedElementsSim.html">LumpedElementsSim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.EigenmodeSim.html">EigenmodeSim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../apidocs/qiskit_metal.analyses.ScatteringImpedanceSim.html">ScatteringImpedanceSim</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../apidocs/renderers.html">QRenderes</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of QRenderes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QRenderer.html">QRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QRendererGui.html">QRendererGui</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QRendererAnalysis.html">QRendererAnalysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.PlotCanvas.html">PlotCanvas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.MplInteraction.html">MplInteraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.ZoomOnWheel.html">ZoomOnWheel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.PanAndZoom.html">PanAndZoom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QMplRenderer.html">QMplRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.AnimatedText.html">AnimatedText</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QGDSRenderer.html">QGDSRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.Cheesing.html">Cheesing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QAnsysRenderer.html">QAnsysRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QHFSSRenderer.html">QHFSSRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QQ3DRenderer.html">QQ3DRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QPyaedt.html">QPyaedt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QQ3DPyaedt.html">QQ3DPyaedt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QHFSSPyaedt.html">QHFSSPyaedt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QHFSSDrivenmodalPyaedt.html">QHFSSDrivenmodalPyaedt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QHFSSEigenmodePyaedt.html">QHFSSEigenmodePyaedt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.QGmshRenderer.html">QGmshRenderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.renderers.Vec3DArray.html">Vec3DArray</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../apidocs/toolbox_metal.html">Toolbox</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Toolbox</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.toolbox_metal.QiskitMetalExceptions.html">QiskitMetalExceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.toolbox_metal.QiskitMetalDesignError.html">QiskitMetalDesignError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.toolbox_metal.about.html">about</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.toolbox_metal.import_export.html">import_export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.toolbox_metal.math_and_overrides.html">math_and_overrides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.toolbox_metal.parsing.html">parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.toolbox_metal.layer_stack_handler.html">layer_stack_handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.toolbox_metal.bounds_for_path_and_poly_tables.html">bounds_for_path_and_poly_tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.toolbox_metal.determine_larger_box.html">determine_larger_box</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../apidocs/qgeometries.html">QGeometry</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of QGeometry</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal.qgeometries.QGeometryTables.html">QGeometryTables</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../apidocs/gui.html">GUI</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of GUI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stubs/qiskit_metal._gui.MetalGUI.html">MetalGUI</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Qiskit/qiskit/blob/master/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
</ul>

</div></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<br><br><br><div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page was generated from <a class="reference external" href="https://github.com/Qiskit/qiskit-metal/blob/main/docs/tut//4-Analysis//4.02-Eigenmode-and-EPR.ipynb">tut//4-Analysis//4.02-Eigenmode-and-EPR.ipynb</a>.</p>
</div>
<section id="Eigenmode-and-EPR-analysis">
<h1>Eigenmode and EPR analysis<a class="headerlink" href="#Eigenmode-and-EPR-analysis" title="Link to this heading">¶</a></h1>
<section id="Prerequisite">
<h2>Prerequisite<a class="headerlink" href="#Prerequisite" title="Link to this heading">¶</a></h2>
<p>You need to have a working local installation of Ansys.</p>
<section id="Sections">
<h3>Sections<a class="headerlink" href="#Sections" title="Link to this heading">¶</a></h3>
</section>
</section>
<section id="I.-Transmon-only">
<h2>I. Transmon only<a class="headerlink" href="#I.-Transmon-only" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Prepare the layout in qiskit-metal.</p></li>
<li><p>Run finite element eigenmode analysis.</p></li>
<li><p>Plot fields and display them.</p></li>
<li><p>Set up EPR junction dictionary.</p></li>
<li><p>Run EPR analysis on single mode.</p></li>
<li><p>Get qubit freq and anharmonicity.</p></li>
<li><p>Calculate EPR of substrate.</p></li>
<li><p>(Extra: Calculate surface EPR.)</p></li>
</ol>
</section>
<section id="II.-Resonator-only">
<h2>II. Resonator only<a class="headerlink" href="#II.-Resonator-only" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Update the layout in qiskit-metal.</p></li>
<li><p>Run finite element eigenmode analysis.</p></li>
<li><p>Plot fields and display them.</p></li>
<li><p>Calculate EPR of substrate.</p></li>
</ol>
</section>
<section id="III.-Transmon-&amp;-resonator">
<h2>III. Transmon &amp; resonator<a class="headerlink" href="#III.-Transmon-&-resonator" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Update the layout in qiskit-metal.</p></li>
<li><p>Run finite element eigenmode analysis.</p></li>
<li><p>Plot fields and display them.</p></li>
<li><p>Set up EPR junction dictionary.</p></li>
<li><p>Run EPR analysis on the two modes.</p></li>
<li><p>Get qubit frequency and anharmonicity.</p></li>
</ol>
</section>
<section id="IV.-Analyze-a-coupled-2-transmon-system.">
<h2>IV. Analyze a coupled 2 transmon system.<a class="headerlink" href="#IV.-Analyze-a-coupled-2-transmon-system." title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Finite Element Eigenmode Analysis</p></li>
<li><p>Identify the mode you want. The mode can inclusively be from 1 to setup.n_modes.</p></li>
<li><p>Set variables in the Ansys design. As before, we seek 2 modes.</p></li>
<li><p>Set up the simulation and specify the variables for the sweep.</p></li>
<li><p>Plot the E-field on the chip’s surface.</p></li>
<li><p>Specify the junctions in the model; in this case there are 2 junctions.</p></li>
<li><p>Find the electric and magnetic energy stored in the substrate and the system as a whole.</p></li>
<li><p>Perform EPR analysis for all modes and variations.</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span> <span class="nn">qiskit_metal</span> <span class="k">as</span> <span class="nn">metal</span>
<span class="kn">from</span> <span class="nn">qiskit_metal</span> <span class="kn">import</span> <span class="n">designs</span><span class="p">,</span> <span class="n">draw</span>
<span class="kn">from</span> <span class="nn">qiskit_metal</span> <span class="kn">import</span> <span class="n">MetalGUI</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Headings</span>
<span class="kn">import</span> <span class="nn">pyEPR</span> <span class="k">as</span> <span class="nn">epr</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="1.-Analyze-the-transmon-qubit-by-itself">
<h1>1. Analyze the transmon qubit by itself<a class="headerlink" href="#1.-Analyze-the-transmon-qubit-by-itself" title="Link to this heading">¶</a></h1>
<p>We will use the analysis package - applicable to most users. Advanced users might want to expand the package, or directly interact with the renderer. The renderer is one of the properties of the analysis class.</p>
<section id="Create-the-Qbit-design">
<h2>Create the Qbit design<a class="headerlink" href="#Create-the-Qbit-design" title="Link to this heading">¶</a></h2>
<p>Setup a design of a given dimension. Dimensions will be respected in the design rendering. Note that the design size extends from the origin into the first quadrant.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">design</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">DesignPlanar</span><span class="p">({},</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">design</span><span class="o">.</span><span class="n">chips</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="s1">&#39;size_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;2mm&#39;</span>
<span class="n">design</span><span class="o">.</span><span class="n">chips</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="s1">&#39;size_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;2mm&#39;</span>

<span class="n">gui</span> <span class="o">=</span> <span class="n">MetalGUI</span><span class="p">(</span><span class="n">design</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Create a single transmon with one readout resonator and move it to the center of the chip previously defined.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit_metal.qlibrary.qubits.transmon_pocket</span> <span class="kn">import</span> <span class="n">TransmonPocket</span>

<span class="n">design</span><span class="o">.</span><span class="n">delete_all_components</span><span class="p">()</span>

<span class="n">q1</span> <span class="o">=</span> <span class="n">TransmonPocket</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">pad_width</span> <span class="o">=</span> <span class="s1">&#39;425 um&#39;</span><span class="p">,</span>
    <span class="n">pocket_height</span> <span class="o">=</span> <span class="s1">&#39;650um&#39;</span><span class="p">,</span>
    <span class="n">connection_pads</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">readout</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">loc_W</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span><span class="n">loc_H</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad_width</span><span class="o">=</span><span class="s1">&#39;200um&#39;</span><span class="p">)</span>
    <span class="p">)))</span>

<span class="n">gui</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
<span class="n">gui</span><span class="o">.</span><span class="n">autoscale</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Finite-Element-Eigenmode-Analysis">
<h2>Finite Element Eigenmode Analysis<a class="headerlink" href="#Finite-Element-Eigenmode-Analysis" title="Link to this heading">¶</a></h2>
<p>Select the analysis you intend to run from the <code class="docutils literal notranslate"><span class="pre">qiskit_metal.analyses</span></code> collection. Select the design to analyze and the tool to use for any external simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit_metal.analyses.quantization</span> <span class="kn">import</span> <span class="n">EPRanalysis</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span> <span class="o">=</span> <span class="n">EPRanalysis</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s2">&quot;hfss&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Review and update the convergence parameters and junction properties by executing following two cells. We exemplify three different methods to update the setup parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;name&#39;: &#39;Setup&#39;,
 &#39;reuse_selected_design&#39;: True,
 &#39;min_freq_ghz&#39;: 1,
 &#39;n_modes&#39;: 1,
 &#39;max_delta_f&#39;: 0.5,
 &#39;max_passes&#39;: 10,
 &#39;min_passes&#39;: 1,
 &#39;min_converged&#39;: 1,
 &#39;pct_refinement&#39;: 30,
 &#39;basis_order&#39;: 1,
 &#39;vars&#39;: {&#39;Lj&#39;: &#39;10 nH&#39;, &#39;Cj&#39;: &#39;0 fF&#39;}}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># example: update single setting</span>
<span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">max_passes</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">vars</span><span class="o">.</span><span class="n">Lj</span> <span class="o">=</span> <span class="s1">&#39;11 nH&#39;</span>
<span class="c1"># example: update multiple settings</span>
<span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup_update</span><span class="p">(</span><span class="n">max_delta_f</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">min_freq_ghz</span> <span class="o">=</span> <span class="mf">1.1</span><span class="p">)</span>

<span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;name&#39;: &#39;Setup&#39;,
 &#39;reuse_selected_design&#39;: True,
 &#39;min_freq_ghz&#39;: 1.1,
 &#39;n_modes&#39;: 1,
 &#39;max_delta_f&#39;: 0.4,
 &#39;max_passes&#39;: 6,
 &#39;min_passes&#39;: 1,
 &#39;min_converged&#39;: 1,
 &#39;pct_refinement&#39;: 30,
 &#39;basis_order&#39;: 1,
 &#39;vars&#39;: {&#39;Lj&#39;: &#39;11 nH&#39;, &#39;Cj&#39;: &#39;0 fF&#39;}}
</pre></div></div>
</div>
<p>Analyze a single qubit with shorted terminations. Then observe the frequency convergence plot. If not converging, you might want to increase the min_passes value to force the renderer to increase accuracy.</p>
<p>You can use the method <code class="docutils literal notranslate"><span class="pre">run()</span></code> instead of <code class="docutils literal notranslate"><span class="pre">sim.run()</span></code> in the following cell if you want to run both eigenmode and epr analysis in a single step. If so, make sure to also tweak the setup for the epr analysis. The input parameters are otherwise the same for the two methods.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Qbit&quot;</span><span class="p">,</span> <span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">],</span> <span class="n">open_terminations</span><span class="o">=</span><span class="p">[],</span> <span class="n">box_plus_buffer</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">plot_convergences</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:35PM [connect_project]: Connecting to Ansys Desktop API...
INFO 10:35PM [load_ansys_project]:      Opened Ansys App
INFO 10:35PM [load_ansys_project]:      Opened Ansys Desktop v2020.2.0
INFO 10:35PM [load_ansys_project]:      Opened Ansys Project
        Folder:    D:/dennis_wang/
        Project:   Project28
INFO 10:35PM [connect_design]: No active design found (or error getting active design).
INFO 10:35PM [connect]:          Connected to project &#34;Project28&#34;. No design detected
INFO 10:35PM [connect_design]:  Opened active design
        Design:    Qbit_hfss [Solution type: Eigenmode]
WARNING 10:35PM [connect_setup]:        No design setup detected.
WARNING 10:35PM [connect_setup]:        Creating eigenmode default setup.
INFO 10:35PM [get_setup]:       Opened setup `Setup`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
INFO 10:35PM [get_setup]:       Opened setup `Setup1`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
INFO 10:35PM [analyze]: Analyzing setup Setup1
10:35PM 48s INFO [get_f_convergence]: Saved convergences to C:\_code_ibmq\qiskit-metal-public\docs\tut\4-Analysis\hfss_eig_f_convergence.csv
</pre></div></div>
</div>
<p>The last variables you pass to the <code class="docutils literal notranslate"><span class="pre">run()</span></code> or <code class="docutils literal notranslate"><span class="pre">sim.run()</span></code> methods, will be stored in the <code class="docutils literal notranslate"><span class="pre">sim.setup</span></code> dictionary under the key <code class="docutils literal notranslate"><span class="pre">run</span></code>. You can recall the information passed by either accessing the dictionary directly, or by using the print handle below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># eig_qb.setup.run    &lt;- direct access</span>
<span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">print_run_args</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
This analysis object run with the following kwargs:
{&#39;name&#39;: &#39;Qbit&#39;, &#39;components&#39;: [&#39;Q1&#39;], &#39;open_terminations&#39;: [], &#39;port_list&#39;: None, &#39;jj_to_port&#39;: None, &#39;ignored_jjs&#39;: None, &#39;box_plus_buffer&#39;: False}

</pre></div></div>
</div>
<p>(optional) Captures the renderer GUI</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_18_0.png" src="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_18_0.png" />
</div>
</div>
<p>(optional) Work directly with the convergence numbers</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">convergence_f</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>re(Mode(1)) [g]</th>
    </tr>
    <tr>
      <th>Pass []</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>3.579716</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.168308</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.923488</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.106727</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.198317</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6.251343</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>(optional) You can re-run the analysis after varying the parameters. Not passing the parameter <code class="docutils literal notranslate"><span class="pre">components</span></code> to the <code class="docutils literal notranslate"><span class="pre">sim.run()</span></code> method, skips the rendering and tries to run the analysis on the latest design. If a design is not found, the full metal design is rendered.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">min_freq_ghz</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">convergence_f</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:35PM [get_setup]:       Opened setup `Setup2`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
INFO 10:35PM [analyze]: Analyzing setup Setup2
10:36PM 19s INFO [get_f_convergence]: Saved convergences to C:\_code_ibmq\qiskit-metal-public\docs\tut\4-Analysis\hfss_eig_f_convergence.csv
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>re(Mode(1)) [g]</th>
    </tr>
    <tr>
      <th>Pass []</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>40.055249</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.850279</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.816798</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.039345</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.152911</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6.222742</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Verify that the Electro(magnetic) fields look realistic.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">plot_fields</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">)</span>   <span class="c1"># TODO:::: Ez, normal component.....decide which field typically on the qbit, or on the crossing between meanders</span>
<span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:36PM [get_setup]:       Opened setup `Setup2`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_24_1.png" src="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_24_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WindowsPath(&#39;C:/_code_ibmq/qiskit-metal-public/docs/tut/4-Analysis/ansys.png&#39;)
</pre></div></div>
</div>
<p>(optional) clear the renderer by removing the fields</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">clear_fields</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="EPR-Analysis">
<h2>EPR Analysis<a class="headerlink" href="#EPR-Analysis" title="Link to this heading">¶</a></h2>
<p>Identify the non-linear (Josephson) junctions in the model. You will need to list the junctions in the epr setup.</p>
<p>In this case there’s only one junction, namely ‘jj’. Let’s see what we need to change in the default setup.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span><span class="o">.</span><span class="n">setup</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;junctions&#39;: {&#39;jj&#39;: {&#39;Lj_variable&#39;: &#39;Lj&#39;,
   &#39;Cj_variable&#39;: &#39;Cj&#39;,
   &#39;rect&#39;: &#39;&#39;,
   &#39;line&#39;: &#39;&#39;}},
 &#39;dissipatives&#39;: {&#39;dielectrics_bulk&#39;: [&#39;main&#39;]},
 &#39;cos_trunc&#39;: 8,
 &#39;fock_trunc&#39;: 7,
 &#39;sweep_variable&#39;: &#39;Lj&#39;}
</pre></div></div>
</div>
<p>The name of the <code class="docutils literal notranslate"><span class="pre">Lj_variable</span></code> and <code class="docutils literal notranslate"><span class="pre">Cj_variable</span></code> match with our model. However it is missing the names of the shapes that identify the junction (<code class="docutils literal notranslate"><span class="pre">rect</span></code> and <code class="docutils literal notranslate"><span class="pre">line</span></code>). Look for those in the renderer and find the name. Then let’s change the name (See below).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">junctions</span><span class="o">.</span><span class="n">jj</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="s1">&#39;JJ_rect_Lj_Q1_rect_jj&#39;</span>
<span class="n">eig_qb</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">junctions</span><span class="o">.</span><span class="n">jj</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;JJ_Lj_Q1_rect_jj_&#39;</span>
<span class="n">eig_qb</span><span class="o">.</span><span class="n">setup</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;junctions&#39;: {&#39;jj&#39;: {&#39;Lj_variable&#39;: &#39;Lj&#39;,
   &#39;Cj_variable&#39;: &#39;Cj&#39;,
   &#39;rect&#39;: &#39;JJ_rect_Lj_Q1_rect_jj&#39;,
   &#39;line&#39;: &#39;JJ_Lj_Q1_rect_jj_&#39;}},
 &#39;dissipatives&#39;: {&#39;dielectrics_bulk&#39;: [&#39;main&#39;]},
 &#39;cos_trunc&#39;: 8,
 &#39;fock_trunc&#39;: 7,
 &#39;sweep_variable&#39;: &#39;Lj&#39;}
</pre></div></div>
</div>
<p>We will now run epr as a single step. On screen you will observe various information in this order: * stored energy = Electric and magnetic energy stored in the substrate and the system as a whole. * EPR analysis results for all modes/variations. * Spectrum analysis. * Hamiltonian report.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span><span class="o">.</span><span class="n">run_epr</span><span class="p">()</span>

<span class="c1">#### equivalent individual calls</span>
<span class="c1"># s = self.setup</span>
<span class="c1"># self.epr_start()</span>
<span class="c1"># eig_qb.get_stored_energy()</span>
<span class="c1"># eig_qb.run_analysis()</span>
<span class="c1"># eig_qb.spectrum_analysis(s.cos_trunc, s.fock_trunc)</span>
<span class="c1"># eig_qb.report_hamiltonian(s.swp_variable)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Design &#34;Qbit_hfss&#34; info:
        # eigenmodes    1
        # variations    1
Design &#34;Qbit_hfss&#34; info:
        # eigenmodes    1
        # variations    1

        energy_elec_all       = 7.72550321519752e-24
        energy_elec_substrate = 7.10552481480507e-24
        EPR of substrate = 92.0%

        energy_mag    = 4.02001475936871e-26
        energy_mag % of energy_elec_all  = 0.5%


Variation 0  [1/1]

  <span class="ansi-bold">Mode 0 at 6.22 GHz   [1/1]</span>
    Calculating ℰ_magnetic,ℰ_electric
       (ℰ_E-ℰ_H)/ℰ_E       ℰ_E       ℰ_H
               99.5%  3.863e-24  2.01e-26

    Calculating junction energy participation ration (EPR)
        method=`line_voltage`. First estimates:
        junction        EPR p_0j   sign s_0j    (p_capacitive)
                Energy fraction (Lj over Lj&amp;Cj)= 96.75%
        jj              0.904053  (+)        0.0304046
                (U_tot_cap-U_tot_ind)/mean=6.25%
Calculating Qdielectric_main for mode 0 (0/0)
p_dielectric_main_0 = 0.9197491240217418
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING 10:36PM [__init__]: &lt;p&gt;Error: &lt;class &#39;IndexError&#39;&gt;&lt;/p&gt;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

ANALYSIS DONE. Data saved to:

C:\data-pyEPR\Project28\Qbit_hfss\2021-08-09 22-36-24.npz


         Differences in variations:



 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Variation 0

Starting the diagonalization
Finished the diagonalization
Pm_norm=
modes
0    1.133646
dtype: float64

Pm_norm idx =
     jj
0  True
*** P (participation matrix, not normlz.)
         jj
0  0.877377

*** S (sign-bit matrix)
   s_jj
0     1
*** P (participation matrix, normalized.)
      0.99

*** Chi matrix O1 PT (MHz)
    Diag is anharmonicity, off diag is full cross-Kerr.
       322

*** Chi matrix ND (MHz)
       361

*** Frequencies O1 PT (MHz)
0    5900.50314
dtype: float64

*** Frequencies ND (MHz)
0    5881.63372
dtype: float64

*** Q_coupling
Empty DataFrame
Columns: []
Index: [0]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="Mode-frequencies-(MHz)">
<h3>Mode frequencies (MHz)<a class="headerlink" href="#Mode-frequencies-(MHz)" title="Link to this heading">¶</a></h3>
</section>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p>Numerical diagonalization</p>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Lj</th>
      <th>11</th>
    </tr>
    <tr>
      <th>eigenmode</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5900.5</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="Kerr-Non-linear-coefficient-table-(MHz)">
<h3>Kerr Non-linear coefficient table (MHz)<a class="headerlink" href="#Kerr-Non-linear-coefficient-table-(MHz)" title="Link to this heading">¶</a></h3>
</section>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p>Numerical diagonalization</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
    </tr>
    <tr>
      <th>Lj</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <th>0</th>
      <td>361.39</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="2.-Analyze-the-CPW-resonator-by-itself">
<h1>2. Analyze the CPW resonator by itself<a class="headerlink" href="#2.-Analyze-the-CPW-resonator-by-itself" title="Link to this heading">¶</a></h1>
<section id="Update-the-design-in-Metal">
<h2>Update the design in Metal<a class="headerlink" href="#Update-the-design-in-Metal" title="Link to this heading">¶</a></h2>
<p>Connect the transmon to a CPW. The other end of the CPW connects to an open to ground termination.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit_metal.qlibrary.terminations.open_to_ground</span> <span class="kn">import</span> <span class="n">OpenToGround</span>
<span class="kn">from</span> <span class="nn">qiskit_metal.qlibrary.tlines.meandered</span> <span class="kn">import</span> <span class="n">RouteMeander</span>
<span class="n">otg</span> <span class="o">=</span> <span class="n">OpenToGround</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;open_to_ground&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">pos_x</span><span class="o">=</span><span class="s1">&#39;1.75mm&#39;</span><span class="p">,</span>  <span class="n">pos_y</span><span class="o">=</span><span class="s1">&#39;0um&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">))</span>
<span class="n">RouteMeander</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;readout&#39;</span><span class="p">,</span>  <span class="n">Dict</span><span class="p">(</span>
        <span class="n">total_length</span><span class="o">=</span><span class="s1">&#39;6 mm&#39;</span><span class="p">,</span>
        <span class="n">hfss_wire_bonds</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">fillet</span><span class="o">=</span><span class="s1">&#39;90 um&#39;</span><span class="p">,</span>
        <span class="n">lead</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">start_straight</span><span class="o">=</span><span class="s1">&#39;100um&#39;</span><span class="p">),</span>
        <span class="n">pin_inputs</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span>
            <span class="n">start_pin</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="n">pin</span><span class="o">=</span><span class="s1">&#39;readout&#39;</span><span class="p">),</span>
            <span class="n">end_pin</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;open_to_ground&#39;</span><span class="p">,</span> <span class="n">pin</span><span class="o">=</span><span class="s1">&#39;open&#39;</span><span class="p">)),</span> <span class="p">))</span>

<span class="n">gui</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
<span class="n">gui</span><span class="o">.</span><span class="n">autoscale</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="id2">
<h2>Finite Element Eigenmode Analysis<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<p>Create a separate analysis object, dedicated to the readout. This allows to retain the Qubit session active, in case we will later need to tweak the design and repeat the simulation. When different renderers are available you could even consider using different more appopriate ones for each simulation steps of this notebook, but for now we will be using the same one.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_rd</span> <span class="o">=</span> <span class="n">EPRanalysis</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s2">&quot;hfss&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For the resonator analysis we will use the default setup. Youn can feel free to edit it the same way we did in section 1.</p>
<p>Analyze the readout in isolation. Select the readout and terminate it with an open on both ends. Note that we are selecting for this analysis both the <code class="docutils literal notranslate"><span class="pre">readout</span></code> component and the <code class="docutils literal notranslate"><span class="pre">open_to_ground</span></code> component. The <code class="docutils literal notranslate"><span class="pre">open_to_ground</span></code> component might feel redundant because we are specifying in that open in the <code class="docutils literal notranslate"><span class="pre">open_terminations</span></code>, and the end converging result is indeed the same. However the <code class="docutils literal notranslate"><span class="pre">open_to_ground</span></code> appears to help the system to converge faster, so we keep it in there.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_rd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Readout&quot;</span><span class="p">,</span>
               <span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;readout&#39;</span><span class="p">,</span> <span class="s1">&#39;open_to_ground&#39;</span><span class="p">],</span>
               <span class="n">open_terminations</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;readout&#39;</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;readout&#39;</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">)])</span>
<span class="n">eig_rd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">plot_convergences</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:36PM [connect_design]:  Opened active design
        Design:    Readout_hfss [Solution type: Eigenmode]
WARNING 10:36PM [connect_setup]:        No design setup detected.
WARNING 10:36PM [connect_setup]:        Creating eigenmode default setup.
INFO 10:36PM [get_setup]:       Opened setup `Setup`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
INFO 10:36PM [get_setup]:       Opened setup `Setup1`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
INFO 10:36PM [analyze]: Analyzing setup Setup1
10:37PM 56s INFO [get_f_convergence]: Saved convergences to C:\_code_ibmq\qiskit-metal-public\docs\tut\4-Analysis\hfss_eig_f_convergence.csv
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_rd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">()</span>  <span class="c1"># optional</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_39_0.png" src="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_39_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WindowsPath(&#39;C:/_code_ibmq/qiskit-metal-public/docs/tut/4-Analysis/ansys.png&#39;)
</pre></div></div>
</div>
<p>Recover eigenmode frequencies for each variation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_rd</span><span class="o">.</span><span class="n">get_frequencies</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Design &#34;Readout_hfss&#34; info:
        # eigenmodes    1
        # variations    1
Design &#34;Readout_hfss&#34; info:
        # eigenmodes    1
        # variations    1
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Freq. (GHz)</th>
      <th>Quality Factor</th>
    </tr>
    <tr>
      <th>variation</th>
      <th>mode</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>0</th>
      <td>9.699888</td>
      <td>inf</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Display the Ansys modeler window and plot the E-field on the chip’s surface.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_rd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">plot_fields</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">)</span>
<span class="n">eig_rd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:38PM [get_setup]:       Opened setup `Setup1`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_43_1.png" src="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_43_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WindowsPath(&#39;C:/_code_ibmq/qiskit-metal-public/docs/tut/4-Analysis/ansys.png&#39;)
</pre></div></div>
</div>
<p>If convergence is not complete, or the EM field is unclear, update the number of passes and re-run the flow (below repeated for convenience)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_rd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">max_passes</span> <span class="o">=</span> <span class="mi">15</span>   <span class="c1"># update single setting</span>
<span class="n">eig_rd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">eig_rd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">plot_convergences</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:38PM [get_setup]:       Opened setup `Setup2`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
INFO 10:38PM [analyze]: Analyzing setup Setup2
10:40PM 10s INFO [get_f_convergence]: Saved convergences to C:\_code_ibmq\qiskit-metal-public\docs\tut\4-Analysis\hfss_eig_f_convergence.csv
</pre></div></div>
</div>
<p>Display the Ansys modeler window again and plot the E-field on the chip’s surface with this updated number of passes. Note that the bright areas have become much smoother compared to the previous image, indicating better convergence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_rd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">plot_fields</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">)</span>
<span class="n">eig_rd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:40PM [get_setup]:       Opened setup `Setup2`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_47_1.png" src="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_47_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WindowsPath(&#39;C:/_code_ibmq/qiskit-metal-public/docs/tut/4-Analysis/ansys.png&#39;)
</pre></div></div>
</div>
</section>
<section id="id3">
<h2>EPR Analysis<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<p>Find the electric and magnetic energy stored in the readout system.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_rd</span><span class="o">.</span><span class="n">run_epr</span><span class="p">(</span><span class="n">no_junctions</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Design &#34;Readout_hfss&#34; info:
        # eigenmodes    1
        # variations    1
Design &#34;Readout_hfss&#34; info:
        # eigenmodes    1
        # variations    1

        energy_elec_all       = 3.54608697054075e-24
        energy_elec_substrate = 3.2323465843058e-24
        EPR of substrate = 91.2%

        energy_mag    = 3.54608766946939e-24
        energy_mag % of energy_elec_all  = 100.0%

</pre></div></div>
</div>
</section>
</section>
<section id="3.-Analyze-the-combined-transmon-+-CPW-resonator-system">
<h1>3. Analyze the combined transmon + CPW resonator system<a class="headerlink" href="#3.-Analyze-the-combined-transmon-+-CPW-resonator-system" title="Link to this heading">¶</a></h1>
<section id="id4">
<h2>Finite Element Eigenmode Analysis<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h2>
<p>Create a separate analysis object for the combined qbit+readout.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qres</span> <span class="o">=</span> <span class="n">EPRanalysis</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s2">&quot;hfss&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For the resonator analysis we look for 2 eigenmodes - one with stronger fields near the transmon, the other with stronger fields near the resonator. Therefore let’s update the setup accordingly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qres</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">n_modes</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">eig_qres</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;name&#39;: &#39;Setup&#39;,
 &#39;reuse_selected_design&#39;: True,
 &#39;min_freq_ghz&#39;: 1,
 &#39;n_modes&#39;: 2,
 &#39;max_delta_f&#39;: 0.5,
 &#39;max_passes&#39;: 10,
 &#39;min_passes&#39;: 1,
 &#39;min_converged&#39;: 1,
 &#39;pct_refinement&#39;: 30,
 &#39;basis_order&#39;: 1,
 &#39;vars&#39;: {&#39;Lj&#39;: &#39;10 nH&#39;, &#39;Cj&#39;: &#39;0 fF&#39;}}
</pre></div></div>
</div>
<p>Analyze the qubit+readout. Select the qubit and the readout, then finalize with open termination on the other pins.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qres</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TransmonResonator&quot;</span><span class="p">,</span>
                 <span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;readout&#39;</span><span class="p">,</span> <span class="s1">&#39;open_to_ground&#39;</span><span class="p">],</span>
                 <span class="n">open_terminations</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;readout&#39;</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">)])</span>
<span class="n">eig_qres</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">plot_convergences</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:40PM [connect_design]:  Opened active design
        Design:    TransmonResonator_hfss [Solution type: Eigenmode]
WARNING 10:40PM [connect_setup]:        No design setup detected.
WARNING 10:40PM [connect_setup]:        Creating eigenmode default setup.
INFO 10:40PM [get_setup]:       Opened setup `Setup`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
INFO 10:40PM [get_setup]:       Opened setup `Setup1`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
INFO 10:40PM [analyze]: Analyzing setup Setup1
10:43PM 51s INFO [get_f_convergence]: Saved convergences to C:\_code_ibmq\qiskit-metal-public\docs\tut\4-Analysis\hfss_eig_f_convergence.csv
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qres</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">()</span>  <span class="c1"># optional</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_56_0.png" src="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_56_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WindowsPath(&#39;C:/_code_ibmq/qiskit-metal-public/docs/tut/4-Analysis/ansys.png&#39;)
</pre></div></div>
</div>
<p>Display the Ansys modeler window again and plot the E-field on the chip’s surface. you can select which of the two modes to visualize.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qres</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">plot_fields</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="n">eigenmode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">eig_qres</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:43PM [get_setup]:       Opened setup `Setup1`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_58_1.png" src="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_58_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WindowsPath(&#39;C:/_code_ibmq/qiskit-metal-public/docs/tut/4-Analysis/ansys.png&#39;)
</pre></div></div>
</div>
</section>
<section id="id5">
<h2>EPR Analysis<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h2>
<p>Similarly to section 1, we need to pass to the renderer the names of the shapes that identify the junction (<code class="docutils literal notranslate"><span class="pre">rect</span></code> and <code class="docutils literal notranslate"><span class="pre">line</span></code>). These should be the same as in section 1, or you can look again for those in the renderer.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qres</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">junctions</span><span class="o">.</span><span class="n">jj</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="s1">&#39;JJ_rect_Lj_Q1_rect_jj&#39;</span>
<span class="n">eig_qres</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">junctions</span><span class="o">.</span><span class="n">jj</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;JJ_Lj_Q1_rect_jj_&#39;</span>
<span class="n">eig_qres</span><span class="o">.</span><span class="n">setup</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;junctions&#39;: {&#39;jj&#39;: {&#39;Lj_variable&#39;: &#39;Lj&#39;,
   &#39;Cj_variable&#39;: &#39;Cj&#39;,
   &#39;rect&#39;: &#39;JJ_rect_Lj_Q1_rect_jj&#39;,
   &#39;line&#39;: &#39;JJ_Lj_Q1_rect_jj_&#39;}},
 &#39;dissipatives&#39;: {&#39;dielectrics_bulk&#39;: [&#39;main&#39;]},
 &#39;cos_trunc&#39;: 8,
 &#39;fock_trunc&#39;: 7,
 &#39;sweep_variable&#39;: &#39;Lj&#39;}
</pre></div></div>
</div>
<p>We will now run epr as a single step. On screen you will observe various information in this order: * stored energy = Electric and magnetic energy stored in the substrate and the system as a whole. * EPR analysis results for all modes/variations. * Spectrum analysis. * Hamiltonian report.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qres</span><span class="o">.</span><span class="n">run_epr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Design &#34;TransmonResonator_hfss&#34; info:
        # eigenmodes    2
        # variations    1
Design &#34;TransmonResonator_hfss&#34; info:
        # eigenmodes    2
        # variations    1

        energy_elec_all       = 7.74800096501779e-24
        energy_elec_substrate = 7.11845568544785e-24
        EPR of substrate = 91.9%

        energy_mag    = 6.71993890387355e-26
        energy_mag % of energy_elec_all  = 0.9%


Variation 0  [1/1]

  <span class="ansi-bold">Mode 0 at 6.22 GHz   [1/2]</span>
    Calculating ℰ_magnetic,ℰ_electric
       (ℰ_E-ℰ_H)/ℰ_E       ℰ_E       ℰ_H
               99.1%  3.874e-24  3.36e-26

    Calculating junction energy participation ration (EPR)
        method=`line_voltage`. First estimates:
        junction        EPR p_0j   sign s_0j    (p_capacitive)
                Energy fraction (Lj over Lj&amp;Cj)= 97.04%
        jj              0.990893  (+)        0.0302452
                (U_tot_cap-U_tot_ind)/mean=1.51%
Calculating Qdielectric_main for mode 0 (0/1)
p_dielectric_main_0 = 0.9187473927258998

  <span class="ansi-bold">Mode 1 at 9.33 GHz   [2/2]</span>
    Calculating ℰ_magnetic,ℰ_electric
       (ℰ_E-ℰ_H)/ℰ_E       ℰ_E       ℰ_H
                0.3%  2.229e-24 2.222e-24

    Calculating junction energy participation ration (EPR)
        method=`line_voltage`. First estimates:
        junction        EPR p_1j   sign s_1j    (p_capacitive)
                Energy fraction (Lj over Lj&amp;Cj)= 93.57%
        jj              0.00305398  (+)        0.000209787
                (U_tot_cap-U_tot_ind)/mean=0.01%
Calculating Qdielectric_main for mode 1 (1/1)
p_dielectric_main_1 = 0.9152273160559548
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING 10:44PM [__init__]: &lt;p&gt;Error: &lt;class &#39;IndexError&#39;&gt;&lt;/p&gt;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

ANALYSIS DONE. Data saved to:

C:\data-pyEPR\Project28\TransmonResonator_hfss\2021-08-09 22-43-59.npz


         Differences in variations:



 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Variation 0

Starting the diagonalization
Finished the diagonalization
Pm_norm=
modes
0    1.030829
1    1.031477
dtype: float64

Pm_norm idx =
      jj
0   True
1  False
*** P (participation matrix, not normlz.)
         jj
0  0.961803
1  0.003053

*** S (sign-bit matrix)
   s_jj
0     1
1     1
*** P (participation matrix, normalized.)
      0.99
    0.0031

*** Chi matrix O1 PT (MHz)
    Diag is anharmonicity, off diag is full cross-Kerr.
       291     2.69
      2.69   0.0062

*** Chi matrix ND (MHz)
       324     2.29
      2.29  0.00453

*** Frequencies O1 PT (MHz)
0    5925.626329
1    9326.061633
dtype: float64

*** Frequencies ND (MHz)
0    5910.137715
1    9326.115494
dtype: float64

*** Q_coupling
Empty DataFrame
Columns: []
Index: [0, 1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="id6">
<h3>Mode frequencies (MHz)<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
</section>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p>Numerical diagonalization</p>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Lj</th>
      <th>10</th>
    </tr>
    <tr>
      <th>eigenmode</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5925.63</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9326.06</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="id7">
<h3>Kerr Non-linear coefficient table (MHz)<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
</section>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p>Numerical diagonalization</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Lj</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">10</th>
      <th>0</th>
      <td>323.51</td>
      <td>2.29e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.29</td>
      <td>4.53e-03</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Once you are sure you are done with the qubit analysis, please explicitly release the Ansys session to allow for a smooth close of the external tool.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_rd</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_qres</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="4.-Analyze-a-coupled-2-transmon-system">
<h1>4. Analyze a coupled 2-transmon system<a class="headerlink" href="#4.-Analyze-a-coupled-2-transmon-system" title="Link to this heading">¶</a></h1>
<section id="Create-the-design">
<h2>Create the design<a class="headerlink" href="#Create-the-design" title="Link to this heading">¶</a></h2>
<p>This is a different system than the one analyzed in sections 1,2,3. Therefore, let’s start by deleting the design currntly in the Qiskit Metal GUI (if any).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">design</span><span class="o">.</span><span class="n">delete_all_components</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Next, we create the <code class="docutils literal notranslate"><span class="pre">TwoTransmon</span></code> design, consisting of 2 transmons connected by a short coupler.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit_metal.qlibrary.qubits.transmon_pocket</span> <span class="kn">import</span> <span class="n">TransmonPocket</span>
<span class="kn">from</span> <span class="nn">qiskit_metal.qlibrary.tlines.straight_path</span> <span class="kn">import</span> <span class="n">RouteStraight</span>

<span class="n">q1</span> <span class="o">=</span> <span class="n">TransmonPocket</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">pad_width</span> <span class="o">=</span> <span class="s1">&#39;425 um&#39;</span><span class="p">,</span>
    <span class="n">pocket_height</span> <span class="o">=</span> <span class="s1">&#39;650um&#39;</span><span class="p">,</span>
    <span class="n">connection_pads</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">readout</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">loc_W</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span><span class="n">loc_H</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad_width</span><span class="o">=</span><span class="s1">&#39;200um&#39;</span><span class="p">)</span>
    <span class="p">)))</span>

<span class="n">q2</span> <span class="o">=</span> <span class="n">TransmonPocket</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">pos_x</span> <span class="o">=</span> <span class="s1">&#39;1.0 mm&#39;</span><span class="p">,</span>
    <span class="n">pad_width</span> <span class="o">=</span> <span class="s1">&#39;425 um&#39;</span><span class="p">,</span>
    <span class="n">pocket_height</span> <span class="o">=</span> <span class="s1">&#39;650um&#39;</span><span class="p">,</span>
    <span class="n">connection_pads</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">readout</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">loc_W</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">loc_H</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad_width</span><span class="o">=</span><span class="s1">&#39;200um&#39;</span><span class="p">)</span>
    <span class="p">)))</span>

<span class="n">coupler</span> <span class="o">=</span> <span class="n">RouteStraight</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s1">&#39;coupler&#39;</span><span class="p">,</span> <span class="n">Dict</span><span class="p">(</span><span class="n">hfss_wire_bonds</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">pin_inputs</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span>
            <span class="n">start_pin</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="n">pin</span><span class="o">=</span><span class="s1">&#39;readout&#39;</span><span class="p">),</span>
            <span class="n">end_pin</span><span class="o">=</span><span class="n">Dict</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="n">pin</span><span class="o">=</span><span class="s1">&#39;readout&#39;</span><span class="p">)),</span> <span class="p">))</span>

<span class="n">gui</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>
<span class="n">gui</span><span class="o">.</span><span class="n">autoscale</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Let’s observe the current table describing the junctions in the qiskit metal design</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">design</span><span class="o">.</span><span class="n">qgeometry</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;junction&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>component</th>
      <th>name</th>
      <th>geometry</th>
      <th>layer</th>
      <th>subtract</th>
      <th>helper</th>
      <th>chip</th>
      <th>width</th>
      <th>hfss_inductance</th>
      <th>hfss_capacitance</th>
      <th>hfss_resistance</th>
      <th>hfss_mesh_kw_jj</th>
      <th>q3d_inductance</th>
      <th>q3d_capacitance</th>
      <th>q3d_resistance</th>
      <th>q3d_mesh_kw_jj</th>
      <th>gds_cell_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>rect_jj</td>
      <td>LINESTRING (0.00000 -0.01500, 0.00000 0.01500)</td>
      <td>1</td>
      <td>False</td>
      <td>False</td>
      <td>main</td>
      <td>0.02</td>
      <td>10nH</td>
      <td>0</td>
      <td>0</td>
      <td>0.000007</td>
      <td>10nH</td>
      <td>0</td>
      <td>0</td>
      <td>0.000007</td>
      <td>my_other_junction</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>rect_jj</td>
      <td>LINESTRING (1.00000 -0.01500, 1.00000 0.01500)</td>
      <td>1</td>
      <td>False</td>
      <td>False</td>
      <td>main</td>
      <td>0.02</td>
      <td>10nH</td>
      <td>0</td>
      <td>0</td>
      <td>0.000007</td>
      <td>10nH</td>
      <td>0</td>
      <td>0</td>
      <td>0.000007</td>
      <td>my_other_junction</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>You can observe in the table above that every junction has been assigned a default inductance, capacitance and resistance values, based on the originating component class <code class="docutils literal notranslate"><span class="pre">default_options</span></code>. In this example we intend to replace those values with a variable name, which will later be set directly in the renderer. Therefore, let’s proceed with updating these values in the qubit instances, and then propagate the update to the table with a <code class="docutils literal notranslate"><span class="pre">rebuild()</span></code>. After executing the cell below, you can
observe the change by re-executing the cell above.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># TODO: fold this inside either an analysis class method, or inside the analysis class setup</span>

<span class="n">qcomps</span> <span class="o">=</span> <span class="n">design</span><span class="o">.</span><span class="n">components</span>  <span class="c1"># short handle (alias)</span>
<span class="n">qcomps</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;hfss_inductance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Lj1&#39;</span>
<span class="n">qcomps</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;hfss_capacitance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Cj1&#39;</span>
<span class="n">qcomps</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;hfss_inductance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Lj2&#39;</span>
<span class="n">qcomps</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;hfss_capacitance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Cj2&#39;</span>
<span class="n">gui</span><span class="o">.</span><span class="n">rebuild</span><span class="p">()</span>  <span class="c1"># line needed to propagate the updates from the qubit instance into the junction design table</span>
<span class="n">gui</span><span class="o">.</span><span class="n">autoscale</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="id8">
<h2>Finite Element Eigenmode Analysis<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h2>
<p>Let’s start the analysis by creating the appropriate analysis object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qiskit_metal.analyses.quantization</span> <span class="kn">import</span> <span class="n">EPRanalysis</span>
<span class="n">eig_2qb</span> <span class="o">=</span> <span class="n">EPRanalysis</span><span class="p">(</span><span class="n">design</span><span class="p">,</span> <span class="s2">&quot;hfss&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now let us update the setup of this analysis to reflect what we plan to do: * define the variables that we have assigned to the inductance and capacitance of the junctions; * increase accuracy of the convergence; * observe the eigenmode corresponding to both qubits.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">max_passes</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">max_delta_f</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">n_modes</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">vars</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">(</span><span class="n">Lj1</span><span class="o">=</span> <span class="s1">&#39;13 nH&#39;</span><span class="p">,</span> <span class="n">Cj1</span><span class="o">=</span> <span class="s1">&#39;0 fF&#39;</span><span class="p">,</span>
                           <span class="n">Lj2</span><span class="o">=</span> <span class="s1">&#39;9 nH&#39;</span><span class="p">,</span> <span class="n">Cj2</span><span class="o">=</span> <span class="s1">&#39;0 fF&#39;</span><span class="p">)</span>
<span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">setup</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;name&#39;: &#39;Setup&#39;,
 &#39;reuse_selected_design&#39;: True,
 &#39;min_freq_ghz&#39;: 1,
 &#39;n_modes&#39;: 2,
 &#39;max_delta_f&#39;: 0.05,
 &#39;max_passes&#39;: 15,
 &#39;min_passes&#39;: 1,
 &#39;min_converged&#39;: 1,
 &#39;pct_refinement&#39;: 30,
 &#39;basis_order&#39;: 1,
 &#39;vars&#39;: {&#39;Lj1&#39;: &#39;13 nH&#39;, &#39;Cj1&#39;: &#39;0 fF&#39;, &#39;Lj2&#39;: &#39;9 nH&#39;, &#39;Cj2&#39;: &#39;0 fF&#39;}}
</pre></div></div>
</div>
<p>By default, the analysis will be done on all components that we will list in the <code class="docutils literal notranslate"><span class="pre">run_sim()</span></code> method, but the analysis needs to know how much of the ground plane around the qubit to consider. One could use the declared chip dimension by passing the parameter <code class="docutils literal notranslate"><span class="pre">bux_plus_buffer</span> <span class="pre">=</span> <span class="pre">False</span></code> to the <code class="docutils literal notranslate"><span class="pre">run_sim()</span></code> method. However, its default (when said parameter is omitted) is to consider the ground plane to be as big as the minimum enclosing rectangle plus a set buffer. The default buffer value is
<code class="docutils literal notranslate"><span class="pre">200um</span></code>, while in the cell below we will increase as an example that buffer to <code class="docutils literal notranslate"><span class="pre">500um</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># TODO: fold this inside either an analysis class method, or inside the analysis class setup</span>

<span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;x_buffer_width_mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;y_buffer_width_mm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">options</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;Lj&#39;: &#39;10nH&#39;,
 &#39;Cj&#39;: 0,
 &#39;_Rj&#39;: 0,
 &#39;max_mesh_length_jj&#39;: &#39;7um&#39;,
 &#39;project_path&#39;: None,
 &#39;project_name&#39;: None,
 &#39;design_name&#39;: None,
 &#39;x_buffer_width_mm&#39;: 0.5,
 &#39;y_buffer_width_mm&#39;: 0.5,
 &#39;wb_threshold&#39;: &#39;400um&#39;,
 &#39;wb_offset&#39;: &#39;0um&#39;,
 &#39;wb_size&#39;: 5,
 &#39;plot_ansys_fields_options&#39;: {&#39;name&#39;: &#39;NAME:Mag_E1&#39;,
  &#39;UserSpecifyName&#39;: &#39;0&#39;,
  &#39;UserSpecifyFolder&#39;: &#39;0&#39;,
  &#39;QuantityName&#39;: &#39;Mag_E&#39;,
  &#39;PlotFolder&#39;: &#39;E Field&#39;,
  &#39;StreamlinePlot&#39;: &#39;False&#39;,
  &#39;AdjacentSidePlot&#39;: &#39;False&#39;,
  &#39;FullModelPlot&#39;: &#39;False&#39;,
  &#39;IntrinsicVar&#39;: &#34;Phase=&#39;0deg&#39;&#34;,
  &#39;PlotGeomInfo_0&#39;: &#39;1&#39;,
  &#39;PlotGeomInfo_1&#39;: &#39;Surface&#39;,
  &#39;PlotGeomInfo_2&#39;: &#39;FacesList&#39;,
  &#39;PlotGeomInfo_3&#39;: &#39;1&#39;}}
</pre></div></div>
</div>
<p>Let’s finally run the cap extraction simulation and observe the convergence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TwoTransmons&quot;</span><span class="p">,</span>
                <span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;coupler&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:44PM [connect_project]: Connecting to Ansys Desktop API...
INFO 10:44PM [load_ansys_project]:      Opened Ansys App
INFO 10:44PM [load_ansys_project]:      Opened Ansys Desktop v2020.2.0
INFO 10:44PM [load_ansys_project]:      Opened Ansys Project
        Folder:    D:/dennis_wang/
        Project:   Project28
INFO 10:44PM [connect_design]:  Opened active design
        Design:    TransmonResonator_hfss [Solution type: Eigenmode]
INFO 10:44PM [get_setup]:       Opened setup `Setup`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
INFO 10:44PM [connect]:         Connected to project &#34;Project28&#34; and design &#34;TransmonResonator_hfss&#34; 😀

INFO 10:44PM [connect_design]:  Opened active design
        Design:    TwoTransmons_hfss [Solution type: Eigenmode]
WARNING 10:44PM [connect_setup]:        No design setup detected.
WARNING 10:44PM [connect_setup]:        Creating eigenmode default setup.
INFO 10:44PM [get_setup]:       Opened setup `Setup`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
INFO 10:44PM [get_setup]:       Opened setup `Setup1`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
INFO 10:44PM [analyze]: Analyzing setup Setup1
10:52PM 50s INFO [get_f_convergence]: Saved convergences to C:\_code_ibmq\qiskit-metal-public\docs\tut\4-Analysis\hfss_eig_f_convergence.csv
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">plot_convergences</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">()</span>  <span class="c1"># optional</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_85_0.png" src="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_85_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WindowsPath(&#39;C:/_code_ibmq/qiskit-metal-public/docs/tut/4-Analysis/ansys.png&#39;)
</pre></div></div>
</div>
<p>Display the Ansys modeler window again and plot the E-field on the chip’s surface. Since we have analyzed 2 modes, you will need to select which mode to visualize. The default is mode 1, but the mode can inclusively be any integer between 1 and <code class="docutils literal notranslate"><span class="pre">setup.n_modes</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">plot_fields</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="n">eigenmode</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:52PM [get_setup]:       Opened setup `Setup1`  (&lt;class &#39;pyEPR.ansys.HfssEMSetup&#39;&gt;)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_87_1.png" src="../../_images/tut_4-Analysis_4.02-Eigenmode-and-EPR_87_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WindowsPath(&#39;C:/_code_ibmq/qiskit-metal-public/docs/tut/4-Analysis/ansys.png&#39;)
</pre></div></div>
</div>
</section>
<section id="id9">
<h2>EPR Analysis<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h2>
<p>Identify the non-linear (Josephson) junctions in the model. in this case there are 2 junctions, which we will refer to as <code class="docutils literal notranslate"><span class="pre">jj1</span></code> and <code class="docutils literal notranslate"><span class="pre">jj2</span></code>. Also define the dissipative reference shapes. Remove the default junction and create the two.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">del</span> <span class="n">eig_2qb</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">junctions</span><span class="p">[</span><span class="s1">&#39;jj&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_2qb</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">junctions</span><span class="o">.</span><span class="n">jj1</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="s1">&#39;JJ_rect_Lj_Q1_rect_jj&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;JJ_Lj_Q1_rect_jj_&#39;</span><span class="p">,</span>
                  <span class="n">Lj_variable</span><span class="o">=</span><span class="s1">&#39;Lj1&#39;</span><span class="p">,</span> <span class="n">Cj_variable</span><span class="o">=</span><span class="s1">&#39;Cj1&#39;</span><span class="p">)</span>
<span class="n">eig_2qb</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">junctions</span><span class="o">.</span><span class="n">jj2</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="s1">&#39;JJ_rect_Lj_Q2_rect_jj&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s1">&#39;JJ_Lj_Q2_rect_jj_&#39;</span><span class="p">,</span>
                  <span class="n">Lj_variable</span><span class="o">=</span><span class="s1">&#39;Lj2&#39;</span><span class="p">,</span> <span class="n">Cj_variable</span><span class="o">=</span><span class="s1">&#39;Cj2&#39;</span><span class="p">)</span>
<span class="n">eig_2qb</span><span class="o">.</span><span class="n">setup</span><span class="o">.</span><span class="n">sweep_variable</span> <span class="o">=</span> <span class="s1">&#39;Lj1&#39;</span>
<span class="n">eig_2qb</span><span class="o">.</span><span class="n">setup</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;junctions&#39;: {&#39;jj1&#39;: {&#39;rect&#39;: &#39;JJ_rect_Lj_Q1_rect_jj&#39;,
   &#39;line&#39;: &#39;JJ_Lj_Q1_rect_jj_&#39;,
   &#39;Lj_variable&#39;: &#39;Lj1&#39;,
   &#39;Cj_variable&#39;: &#39;Cj1&#39;},
  &#39;jj2&#39;: {&#39;rect&#39;: &#39;JJ_rect_Lj_Q2_rect_jj&#39;,
   &#39;line&#39;: &#39;JJ_Lj_Q2_rect_jj_&#39;,
   &#39;Lj_variable&#39;: &#39;Lj2&#39;,
   &#39;Cj_variable&#39;: &#39;Cj2&#39;}},
 &#39;dissipatives&#39;: {&#39;dielectrics_bulk&#39;: [&#39;main&#39;]},
 &#39;cos_trunc&#39;: 8,
 &#39;fock_trunc&#39;: 7,
 &#39;sweep_variable&#39;: &#39;Lj1&#39;}
</pre></div></div>
</div>
<p>Find the electric and magnetic energy stored in the substrate and the system as a whole.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_2qb</span><span class="o">.</span><span class="n">run_epr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Design &#34;TwoTransmons_hfss&#34; info:
        # eigenmodes    2
        # variations    1
Design &#34;TwoTransmons_hfss&#34; info:
        # eigenmodes    2
        # variations    1

        energy_elec_all       = 2.01926030136048e-25
        energy_elec_substrate = 1.86157115120032e-25
        EPR of substrate = 92.2%

        energy_mag    = 1.19184318501109e-27
        energy_mag % of energy_elec_all  = 0.6%


Variation 0  [1/1]

  <span class="ansi-bold">Mode 0 at 5.63 GHz   [1/2]</span>
    Calculating ℰ_magnetic,ℰ_electric
       (ℰ_E-ℰ_H)/ℰ_E       ℰ_E       ℰ_H
               99.6%  1.842e-25 7.433e-28

    Calculating junction energy participation ration (EPR)
        method=`line_voltage`. First estimates:
        junction        EPR p_0j   sign s_0j    (p_capacitive)
                Energy fraction (Lj over Lj&amp;Cj)= 96.85%
        jj1             0.995334  (+)        0.0323716
                Energy fraction (Lj over Lj&amp;Cj)= 97.80%
        jj2             0.000371363  (+)        8.36166e-06
                (U_tot_cap-U_tot_ind)/mean=1.61%
Calculating Qdielectric_main for mode 0 (0/1)
p_dielectric_main_0 = 0.9217300945173436

  <span class="ansi-bold">Mode 1 at 6.77 GHz   [2/2]</span>
    Calculating ℰ_magnetic,ℰ_electric
       (ℰ_E-ℰ_H)/ℰ_E       ℰ_E       ℰ_H
               99.4%   1.01e-25 5.959e-28

    Calculating junction energy participation ration (EPR)
        method=`line_voltage`. First estimates:
        junction        EPR p_1j   sign s_1j    (p_capacitive)
                Energy fraction (Lj over Lj&amp;Cj)= 95.51%
        jj1             0.000376657  (+)        1.77018e-05
                Energy fraction (Lj over Lj&amp;Cj)= 96.85%
        jj2              0.99309  (+)        0.0323117
                (U_tot_cap-U_tot_ind)/mean=1.62%
Calculating Qdielectric_main for mode 1 (1/1)
p_dielectric_main_1 = 0.9219074677722745
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING 10:53PM [__init__]: &lt;p&gt;Error: &lt;class &#39;IndexError&#39;&gt;&lt;/p&gt;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

ANALYSIS DONE. Data saved to:

C:\data-pyEPR\Project28\TwoTransmons_hfss\2021-08-09 22-53-00.npz


         Differences in variations:



 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Variation 0

Starting the diagonalization
Finished the diagonalization
Pm_norm=
modes
0    1.032715
1    1.033081
dtype: float64

Pm_norm idx =
     jj1    jj2
0   True  False
1  False   True
*** P (participation matrix, not normlz.)
        jj1       jj2
0  0.964116  0.000360
1  0.000365  0.961989

*** S (sign-bit matrix)
   s_jj1  s_jj2
0      1      1
1      1      1
*** P (participation matrix, normalized.)
         1  0.00036
   0.00036     0.99

*** Chi matrix O1 PT (MHz)
    Diag is anharmonicity, off diag is full cross-Kerr.
       312    0.463
     0.463      311

*** Chi matrix ND (MHz)
       353     1.04
      1.04      344

*** Frequencies O1 PT (MHz)
0    5316.502727
1    6455.124200
dtype: float64

*** Frequencies ND (MHz)
0    5296.470709
1    6439.252259
dtype: float64

*** Q_coupling
Empty DataFrame
Columns: []
Index: [0, 1]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO 10:53PM [__del__]: Disconnected from Ansys HFSS
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="id10">
<h3>Mode frequencies (MHz)<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
</section>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p>Numerical diagonalization</p>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Lj1</th>
      <th>13</th>
    </tr>
    <tr>
      <th>eigenmode</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5316.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6455.12</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="id11">
<h3>Kerr Non-linear coefficient table (MHz)<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
</section>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<p>Numerical diagonalization</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Lj1</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">13</th>
      <th>0</th>
      <td>353.30</td>
      <td>1.04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.04</td>
      <td>344.23</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Release Ansys’s session</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eig_2qb</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>(optional) <strong>final wrap</strong>: Close the gui by removing the # in the line below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># gui.main_window.close()</span>
</pre></div>
</div>
</div>
</section>
</section>
<h3>For more information, review the <b>Introduction to Quantum Computing and Quantum Hardware</b> lectures below</h3>
<div style="border:solid 1 px #990000;">
<table>
<tr><td><ul><li>Superconducting Qubits I: Quantizing a Harmonic Oscillator, Josephson Junctions Part 1</ul></td>
<td width="15%"><a href="https://www.youtube.com/watch?v=eZJjQGu85Ps&list=PLOFEBzvs-VvrXTMy5Y2IqmSaUjfnhvBHR">Lecture Video</a></td>
<td width="15%"><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/lectures/introqcqh-lecture-notes-6.pdf?raw=true">Lecture Notes</a></td>
<td width="5%"><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/labs/introqcqh-lab-6.zip?raw=true">Lab</a></td></tr>
<tr><td><ul><li>Superconducting Qubits I: Quantizing a Harmonic Oscillator, Josephson Junctions Part 2</ul></td>
<td><a href="https://www.youtube.com/watch?v=SDiiFOham6Y&list=PLOFEBzvs-VvrXTMy5Y2IqmSaUjfnhvBHR">Lecture Video</a></td>
<td><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/lectures/introqcqh-lecture-notes-6.pdf?raw=true">Lecture Notes</a></td>
<td><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/labs/introqcqh-lab-6.zip?raw=true">Lab</a></td></tr>
<tr><td><ul><li>Superconducting Qubits I: Quantizing a Harmonic Oscillator, Josephson Junctions Part 3</ul></td>
<td><a href="https://www.youtube.com/watch?v=hGBAz63NIH8&list=PLOFEBzvs-VvrXTMy5Y2IqmSaUjfnhvBHR">Lecture Video</a></td>
<td><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/lectures/introqcqh-lecture-notes-6.pdf?raw=true">Lecture Notes</a></td>
<td><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/labs/introqcqh-lab-6.zip?raw=true">Lab</a></td></tr>
<tr><td><ul><li>Superconducting Qubits II: Circuit Quantum Electrodynamics, Readout and Calibration Methods Part 1</ul></td>
<td><a href="https://www.youtube.com/watch?v=dmYnfGo-8eM&list=PLOFEBzvs-VvrXTMy5Y2IqmSaUjfnhvBHR">Lecture Video</a></td>
<td><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/lectures/introqcqh-lecture-notes-7.pdf?raw=true">Lecture Notes</a></td>
<td><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/labs/introqcqh-lab-7.zip?raw=true">Lab</a></td></tr>
<tr><td><ul><li>Superconducting Qubits II: Circuit Quantum Electrodynamics, Readout and Calibration Methods Part 2</ul></td>
<td><a href="https://www.youtube.com/watch?v=jUPAeOoZpEU&list=PLOFEBzvs-VvrXTMy5Y2IqmSaUjfnhvBHR">Lecture Video</a></td>
<td><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/lectures/introqcqh-lecture-notes-7.pdf?raw=true">Lecture Notes</a></td>
<td><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/labs/introqcqh-lab-7.zip?raw=true">Lab</a></td></tr>
<tr><td><ul><li>Superconducting Qubits II: Circuit Quantum Electrodynamics, Readout and Calibration Methods Part 3</ul></td>
<td><a href="https://www.youtube.com/watch?v=_IpCwMvc0dA&list=PLOFEBzvs-VvrXTMy5Y2IqmSaUjfnhvBHR">Lecture Video</a></td>
<td><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/lectures/introqcqh-lecture-notes-7.pdf?raw=true">Lecture Notes</a></td>
<td><a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/labs/introqcqh-lab-7.zip?raw=true">Lab</a></td></tr></table>
</div>
        </article>
      </div>
      <footer>
        <div class="related-pages">
          <a class="next-page" href="4.03-Impedance.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Impedance, admittance and scattering analysis</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="4.01-Capacitance-and-LOM.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Capacitance matrix and LOM analysis</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2019, Qiskit Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 2025/10/27</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Eigenmode and EPR analysis</a><ul>
<li><a class="reference internal" href="#Prerequisite">Prerequisite</a><ul>
<li><a class="reference internal" href="#Sections">Sections</a></li>
</ul>
</li>
<li><a class="reference internal" href="#I.-Transmon-only">I. Transmon only</a></li>
<li><a class="reference internal" href="#II.-Resonator-only">II. Resonator only</a></li>
<li><a class="reference internal" href="#III.-Transmon-&amp;-resonator">III. Transmon &amp; resonator</a></li>
<li><a class="reference internal" href="#IV.-Analyze-a-coupled-2-transmon-system.">IV. Analyze a coupled 2 transmon system.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#1.-Analyze-the-transmon-qubit-by-itself">1. Analyze the transmon qubit by itself</a><ul>
<li><a class="reference internal" href="#Create-the-Qbit-design">Create the Qbit design</a></li>
<li><a class="reference internal" href="#Finite-Element-Eigenmode-Analysis">Finite Element Eigenmode Analysis</a></li>
<li><a class="reference internal" href="#EPR-Analysis">EPR Analysis</a></li>
</ul>
</li>
<li><a class="reference internal" href="#2.-Analyze-the-CPW-resonator-by-itself">2. Analyze the CPW resonator by itself</a><ul>
<li><a class="reference internal" href="#Update-the-design-in-Metal">Update the design in Metal</a></li>
<li><a class="reference internal" href="#id2">Finite Element Eigenmode Analysis</a></li>
<li><a class="reference internal" href="#id3">EPR Analysis</a></li>
</ul>
</li>
<li><a class="reference internal" href="#3.-Analyze-the-combined-transmon-+-CPW-resonator-system">3. Analyze the combined transmon + CPW resonator system</a><ul>
<li><a class="reference internal" href="#id4">Finite Element Eigenmode Analysis</a></li>
<li><a class="reference internal" href="#id5">EPR Analysis</a></li>
</ul>
</li>
<li><a class="reference internal" href="#4.-Analyze-a-coupled-2-transmon-system">4. Analyze a coupled 2-transmon system</a><ul>
<li><a class="reference internal" href="#Create-the-design">Create the design</a></li>
<li><a class="reference internal" href="#id8">Finite Element Eigenmode Analysis</a></li>
<li><a class="reference internal" href="#id9">EPR Analysis</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=59fadc99"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/qiskit-sphinx-theme.js?v=4d77b8ca"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>